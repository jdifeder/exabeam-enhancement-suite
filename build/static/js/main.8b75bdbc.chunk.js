(this["webpackJsonpexabeam-enhancement-suite-react"] = this["webpackJsonpexabeam-enhancement-suite-react"] || []).push([[0],{

/***/ 123:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin

/***/ }),

/***/ 124:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin

/***/ }),

/***/ 134:
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 135:
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 136:
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 137:
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 138:
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 139:
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 141:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(1);
var react_default = /*#__PURE__*/__webpack_require__.n(react);

// EXTERNAL MODULE: ./node_modules/react-dom/index.js
var react_dom = __webpack_require__(11);
var react_dom_default = /*#__PURE__*/__webpack_require__.n(react_dom);

// EXTERNAL MODULE: ./node_modules/primereact/datatable.js
var datatable = __webpack_require__(12);

// EXTERNAL MODULE: ./node_modules/primereact/button.js
var primereact_button = __webpack_require__(5);

// EXTERNAL MODULE: ./node_modules/primereact/card.js
var card = __webpack_require__(20);

// EXTERNAL MODULE: ./node_modules/primereact/dialog.js
var dialog = __webpack_require__(13);

// EXTERNAL MODULE: ./node_modules/primereact/column.js
var column = __webpack_require__(3);

// EXTERNAL MODULE: ./node_modules/primereact/inputtext.js
var inputtext = __webpack_require__(15);

// EXTERNAL MODULE: ./node_modules/primereact/treetable.js
var treetable = __webpack_require__(31);

// EXTERNAL MODULE: ./node_modules/primereact/progressbar.js
var progressbar = __webpack_require__(27);

// EXTERNAL MODULE: ./node_modules/primereact/divider.js
var divider = __webpack_require__(99);

// EXTERNAL MODULE: ./node_modules/primereact/tabview.js
var tabview = __webpack_require__(21);

// EXTERNAL MODULE: ./node_modules/primereact/badge.js
var badge = __webpack_require__(17);

// EXTERNAL MODULE: ./node_modules/mobx-react-lite/es/index.js + 17 modules
var es = __webpack_require__(18);

// EXTERNAL MODULE: ./node_modules/react-json-view/dist/main.js
var main = __webpack_require__(52);
var main_default = /*#__PURE__*/__webpack_require__.n(main);

// EXTERNAL MODULE: ./node_modules/react-number-format/dist/react-number-format.es.js
var react_number_format_es = __webpack_require__(53);

// EXTERNAL MODULE: ./node_modules/axios/index.js
var axios = __webpack_require__(14);
var axios_default = /*#__PURE__*/__webpack_require__.n(axios);

// EXTERNAL MODULE: ./node_modules/@fortawesome/react-fontawesome/index.es.js
var index_es = __webpack_require__(46);

// EXTERNAL MODULE: ./node_modules/mobx/dist/mobx.esm.js
var mobx_esm = __webpack_require__(7);

// EXTERNAL MODULE: ./node_modules/primereact/resources/themes/saga-blue/theme.css
var theme = __webpack_require__(47);

// EXTERNAL MODULE: ./node_modules/primereact/resources/primereact.min.css
var primereact_min = __webpack_require__(48);

// EXTERNAL MODULE: ./node_modules/primeicons/primeicons.css
var primeicons = __webpack_require__(49);

// EXTERNAL MODULE: ./node_modules/primeflex/primeflex.css
var primeflex = __webpack_require__(122);

// EXTERNAL MODULE: ./src/dataTable.css
var dataTable = __webpack_require__(123);

// EXTERNAL MODULE: ./src/index.css
var src = __webpack_require__(124);

// EXTERNAL MODULE: ./node_modules/primereact/toast.js
var toast = __webpack_require__(125);

// EXTERNAL MODULE: ./node_modules/primereact/listbox.js
var listbox = __webpack_require__(128);

// EXTERNAL MODULE: ./node_modules/dexie/dist/dexie.mjs
var dexie = __webpack_require__(16);

// EXTERNAL MODULE: ./node_modules/moment/moment.js
var moment = __webpack_require__(32);

// EXTERNAL MODULE: ./node_modules/typescript/lib/typescript.js
var typescript = __webpack_require__(133);

// EXTERNAL MODULE: ./node_modules/react/jsx-dev-runtime.js
var jsx_dev_runtime = __webpack_require__(0);

// CONCATENATED MODULE: ./src/Home.js
var _jsxFileName="C:\\Users\\johnj\\Documents\\exabeam-enhancement-suite\\src\\Home.js";/*global chrome*/Object(mobx_esm["b" /* configure */])({enforceActions:"never"});class Home_Home{constructor(){this.showStart=true;this.showHome=false;this.showLogin=false;this.showTuning=false;this.showEvents=false;this.showValidation=false;this.onPreviousSession=false;this.showpRuleTuning=false;this.showpDataValidation=false;this.visibleDataValidationProgress=false;this.visibleTuningProgress=false;this.visibleMissingEventTypes=false;this.visibleSelectedSource=false;this.visibleMissingEventFields=false;this.visibleRule=false;this.visibleModel=false;this.visibleUserList=false;this.visibleHostList=false;this.visibleParsingIssues=false;this.loading=false;this.bannedEvents=[];this.eventSummaryDataDone=[];this.errors=[];this.rawEventErrors=0;this.errorVisible=false;this.host='';this.nodeServer='https://exabeam.azurewebsites.net/api/exabeam-cloud';this.username='';this.password='';this.queryUnit='d';this.queryUnitNum='7';this.queryRiskScore='90';this.queryLimit='100000';this.queryLimitDV='100000';this.allowedCount=5;this.allowedEventTypeCount=2;this.allowedEventsPerSession=5;this.allowedEventTypeSessionCount=0;this.allowedEventDetailCount=5;this.allowedRawEventCount=0;this.doneCount=0;this.doneCountTimelines=0;this.doneCountModels=0;this.doneCountRules=0;this.doneCountEventTypes=0;this.doneCountEventTypeSessions=0;this.doneCountEventTypeAssets=0;this.doneCountEventTypeSessionsDetails=0;this.doneCountEventTypeAssetsDetails=0;this.doneCountEvents=0;this.doneCountSessions=0;this.todoRawEventsCount=0;this.doneRawEventsCount=0;this.validDoneRawEventsCount=0;this.retryAttemptRawEventsCount=0;this.trueOrFalse=[{label:'True',value:'true'},{label:'False',value:'false'}];this.trueOrFalseOrNA=[{label:'True',value:'true'},{label:'False',value:'false'},{label:'N/A',value:'N/A'}];this.activeEventTypes=0;this.activeEventTypeSessions=0;this.activeEventTypeAssets=0;this.activeRawEvents=0;this.pRuleTuningTable=[];this.pDataValidationTable=[];this.previousRuleTuningGlobalFilter='';this.previousDataValidationGlobalFilter='';this.userDataGlobalFilter='';this.ruleDataGlobalFilter='';this.eventSummaryGlobalFilter='';this.sourcesGlobalFilter='';this.eventTypesGlobalFilter='';this.rulesAndModelsGlobalFilter='';this.doneEventTypes=[];this.doneEventTypeSessions=[];this.doneEventTypeAssets=[];this.doneEventTypeSessionsDetails=[];this.doneEventTypeAssetsDetails=[];this.doneRawEvents=[];this.onHide=name=>{this[name]=false;};this.openTableButtonRuleTuning=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-folder-open",onClick:()=>this.selTuningSession(rowData)},void 0,false,{fileName:_jsxFileName,lineNumber:196,columnNumber:12},this);};this.delTableButtonRuleTuning=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-trash",onClick:()=>this.delPreviousRuleTuning(rowData)},void 0,false,{fileName:_jsxFileName,lineNumber:200,columnNumber:12},this);};this.openTableButtonDataValidation=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-folder-open",onClick:()=>this.selDvSession(rowData)},void 0,false,{fileName:_jsxFileName,lineNumber:204,columnNumber:12},this);};this.delTableButtonDataValidation=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-trash",onClick:()=>this.delPreviousDataValidation(rowData)},void 0,false,{fileName:_jsxFileName,lineNumber:208,columnNumber:12},this);};this.openTableButtonSelectRule=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-folder-open",onClick:()=>this.onRowSelect(rowData)},void 0,false,{fileName:_jsxFileName,lineNumber:212,columnNumber:12},this);};this.openTableButtonFilterEvent=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-filter ",onClick:()=>this.tuneRule(rowData)},void 0,false,{fileName:_jsxFileName,lineNumber:216,columnNumber:12},this);};this.openTableButtonSelectSource=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-folder-open",onClick:()=>this.onSourceSelect(rowData.sessionEvents,rowData.assetEvents,'AA User Session Events','AA Asset Session Events')},void 0,false,{fileName:_jsxFileName,lineNumber:220,columnNumber:12},this);};this.openTableButtonSelectConfigIssue=(rowData,props)=>{let booleanString='0';if(typeof rowData[props.field]!=='undefined')booleanString=rowData[props.field].toString();return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:rowData[props.field]>0?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("i",{className:"pi pi-bell p-mr-4 p-text-secondary p-overlay-badge",style:{fontSize:"1rem",cursor:"pointer"},onClick:()=>this.onSourceSelect(rowData.sessionConfigIssueEvents,rowData.assetConfigIssueEvents,'User Events Missing From Asset Timelines','Asset Events Missing From User Timelines'),children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(badge["Badge"],{severity:"danger",value:booleanString},void 0,false,{fileName:_jsxFileName,lineNumber:231,columnNumber:15},this)},void 0,false,{fileName:_jsxFileName,lineNumber:230,columnNumber:13},this)},void 0,false):/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(badge["Badge"],{value:booleanString,className:"p-mr-2"},void 0,false,{fileName:_jsxFileName,lineNumber:236,columnNumber:13},this)},void 0,false)},void 0,false);};this.openTableButtonSelectParsingIssue=(rowData,props)=>{let booleanString='0';if(typeof rowData[props.field]!=='undefined')booleanString=rowData[props.field].toString();return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:rowData[props.field]>0?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("i",{className:"pi pi-bell p-mr-4 p-text-secondary p-overlay-badge",style:{fontSize:"1rem",cursor:"pointer"},onClick:()=>this.onParsingIssueSelect(rowData.aaSessionEventParsingIssues,rowData.aaAssetEventParsingIssues),children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(badge["Badge"],{severity:"danger",value:booleanString},void 0,false,{fileName:_jsxFileName,lineNumber:252,columnNumber:15},this)},void 0,false,{fileName:_jsxFileName,lineNumber:251,columnNumber:13},this)},void 0,false):/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(badge["Badge"],{value:booleanString,className:"p-mr-2"},void 0,false,{fileName:_jsxFileName,lineNumber:257,columnNumber:13},this)},void 0,false)},void 0,false);};this.selectedRuleHeader=()=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:["Summary for ",this.selectedRule]},void 0,true,{fileName:_jsxFileName,lineNumber:265,columnNumber:12},this);};this.eventTypeUsers=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-folder-open",onClick:()=>this.onUsersSelect(rowData.uniqueUsersList)},void 0,false,{fileName:_jsxFileName,lineNumber:271,columnNumber:7},this),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[" ",rowData.uniqueUsers," / ",this.summary.uniqueUserCount," "]},void 0,true,{fileName:_jsxFileName,lineNumber:272,columnNumber:7},this),rowData.uniqueUserPercent?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{style:{color:'green'},children:["(",rowData.uniqueUserPercent,"%) "]},void 0,true,{fileName:_jsxFileName,lineNumber:273,columnNumber:36},this):false]},void 0,true);};this.eventTypeHosts=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-folder-open",onClick:()=>this.onHostsSelect(rowData.uniqueHostsList)},void 0,false,{fileName:_jsxFileName,lineNumber:281,columnNumber:7},this),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[" ",rowData.uniqueHosts," / ",this.summary.uniqueHostCount," "]},void 0,true,{fileName:_jsxFileName,lineNumber:282,columnNumber:7},this),rowData.uniqueHostPercent?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{style:{color:'green'},children:["(",rowData.uniqueHostPercent,"%) "]},void 0,true,{fileName:_jsxFileName,lineNumber:283,columnNumber:36},this):false]},void 0,true);};this.eventTypeFields=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-folder-open",onClick:()=>this.onEventFieldsSelect(rowData.sessionEventFields,rowData.assetEventFields,rowData.missingEventFieldTable)},void 0,false,{fileName:_jsxFileName,lineNumber:291,columnNumber:7},this),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[" ",rowData.fieldsPopulating," / ",rowData.fieldCount," "]},void 0,true,{fileName:_jsxFileName,lineNumber:292,columnNumber:7},this),rowData.fieldsPopulatingPercent?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{style:{color:'green'},children:["(",rowData.fieldsPopulatingPercent,"%) "]},void 0,true,{fileName:_jsxFileName,lineNumber:293,columnNumber:42},this):false]},void 0,true);};this.eventTypeModelsPopulating=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[rowData.modelsPopulating," / ",rowData.modelCount," "]},void 0,true,{fileName:_jsxFileName,lineNumber:301,columnNumber:7},this),rowData.modelsPopulatingPercent?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{style:{color:'green'},children:["(",rowData.modelsPopulatingPercent,"%) "]},void 0,true,{fileName:_jsxFileName,lineNumber:302,columnNumber:42},this):false]},void 0,true);};this.eventTypeRulesCouldTrigger=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[rowData.rulesCouldTrigger," / ",rowData.ruleCount," "]},void 0,true,{fileName:_jsxFileName,lineNumber:310,columnNumber:7},this),rowData.rulesCouldTriggerPercent?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{style:{color:'green'},children:["(",rowData.rulesCouldTriggerPercent,"%) "]},void 0,true,{fileName:_jsxFileName,lineNumber:311,columnNumber:43},this):false]},void 0,true);};this.rulesAndModelsRuleId=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-folder-open",onClick:()=>this.onRuleSelect(rowData.ruleDef)},void 0,false,{fileName:_jsxFileName,lineNumber:319,columnNumber:7},this),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[" ",rowData.ruleId]},void 0,true,{fileName:_jsxFileName,lineNumber:320,columnNumber:7},this)]},void 0,true);};this.rulesAndModelsModelName=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-folder-open",onClick:()=>this.onModelSelect(rowData.modelDef)},void 0,false,{fileName:_jsxFileName,lineNumber:328,columnNumber:7},this),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[" ",rowData.modelName]},void 0,true,{fileName:_jsxFileName,lineNumber:329,columnNumber:7},this)]},void 0,true);};this.rulesAndModelsEventInRule=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{icon:"pi pi-folder-open",onClick:()=>this.onEventTypesSelect(rowData.ruleDef.requiredEvents,rowData.presentEventTypes)},void 0,false,{fileName:_jsxFileName,lineNumber:337,columnNumber:7},this),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[" ",rowData.eventInRuleType.toString()]},void 0,true,{fileName:_jsxFileName,lineNumber:338,columnNumber:7},this)]},void 0,true);};this.eventFieldsMissingTable=rowData=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:rowData.percent?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{style:{color:'green'},children:["(",rowData.percent,"%) "]},void 0,true,{fileName:_jsxFileName,lineNumber:346,columnNumber:26},this):false},void 0,false);};this.booleanFormat=(rowData,props)=>{let booleanString='';if(typeof rowData[props.field]!=='undefined')booleanString=rowData[props.field].toString();return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[booleanString," "]},void 0,true,{fileName:_jsxFileName,lineNumber:356,columnNumber:7},this)},void 0,false);};Object(mobx_esm["d" /* makeAutoObservable */])(this,{getNotables:false,fixArray:false,getSequences:false,arraySum:false,combineArrays:false,findRequiredData:false,getEventTypes:false,getEventTypeSessions:false,getEventTypeSessionDetails:false,getEventTypeAssetDetails:false,checkEventTypeSessionDetails:false,checkEventTypeAssetDetails:false,getRawEvents:false,bootstrapEventTypes:false,checkFeature:false,checkMissingEvents:false,addEventDetails:false,determineSources:false});this.sessionParsingIssues=[];this.assetParsingIssues=[];this.selectedSessionUser=[];this.selectedSessionSrcIp=[];this.selectedSessionSrcHost=[];this.selectedSessionDestIp=[];this.selectedSessionDestHost=[];this.selectedSessionHost=[];this.selectedAssetUser=[];this.selectedAssetSrcIp=[];this.selectedAssetSrcHost=[];this.selectedAssetDestIp=[];this.selectedAssetDestHost=[];this.selectedAssetHost=[];}getTab(){this.showStart=false;chrome.tabs.query({active:true,currentWindow:true},([{id,url}])=>{console.log('url = ',url);console.log('id = ',id);this.tabID=id;this.host=url.split('https://')[1].substr(0,url.split('https://')[1].indexOf('/'));console.log('this.host = ',this.host);this.getDB();});}sleep(milliseconds){const date=Date.now();let currentDate=null;do{currentDate=Date.now();}while(currentDate-date<milliseconds);}async getDB(){this.dbName='exabeamEnhancementSuite'+'-'+this.host;this.ruleTuningDb='ruleTuning';this.dataValidationDb='dataValidation';this.tableNames=[];this.dbStores={};this.tableNames.push(this.ruleTuningDb);this.tableNames.push(this.dataValidationDb);this.tableNames.forEach(tableName=>{this.dbStores[tableName]='++id,date,type';// where schema is a string containing the primary key name + "," + a comma-delimited list of indexes.
});var db=new dexie["a" /* default */](this.dbName);db.version(1).stores(this.dbStores);this.tempRuleTable=await db.table(this.ruleTuningDb).toArray();// this.previousRuleTuning = await db.table(this.ruleTuningDb).toArray();
this.previousRuleTuning=[];this.tempDvTable=await db.table(this.dataValidationDb).toArray();this.previousDataValidation=[];//this.previousDataValidation = await db.table(this.dataValidationDb).toArray();
this.afterDB();}afterDB(){if(this.tempRuleTable.length!==0){this.tempRuleTable.forEach(obj=>{this.previousRuleTuning.push({id:obj.id,date:obj.date,daysQueried:obj.daysQueried,riskScore:obj.riskScore,type:obj.type,uSessionSummaryRiskScore:obj.uSessionSummaryRiskScore,uSessionSummarySessionCount:obj.uSessionSummarySessionCount,uSessionSummaryNotableCount:obj.uSessionSummaryNotableCount,uSessionSummaryNotablePerDay:obj.uSessionSummaryNotablePerDay});});this.tempRuleTable=[];this.showpRuleTuning=true;}if(this.tempDvTable.length!==0){this.tempDvTable.forEach(obj=>{this.previousDataValidation.push({id:obj.id,date:obj.date,daysQueried:obj.daysQueried});});this.tempDvTable=[];this.showpDataValidation=true;}this.showpRuleTuning=!this.showpRuleTuning;this.showpRuleTuning=!this.showpRuleTuning;this.showpDataValidation=!this.showpDataValidation;this.showpDataValidation=!this.showpDataValidation;this.previousRuleTuning.forEach(obj=>{obj.epochDate=obj.date;obj.date=moment(obj.date).format('lll');if(obj.type==='session')obj.type='user';});this.previousDataValidation.forEach(obj=>{obj.epochDate=obj.date;obj.date=moment(obj.date).format('lll');});console.log('this.previousRuleTuning = ',this.previousRuleTuning);console.log('this.previousDataValidation = ',this.previousDataValidation);this.pRuleTuningColumns=[{field:'date',header:'Date Run'},{field:'daysQueried',header:'Days Queried'},{field:'riskScore',header:'Min Risk Score'},{field:'type',header:'Session Type'},{field:'uSessionSummaryRiskScore',header:'Session Scores'},{field:'uSessionSummarySessionCount',header:'Session Count'},{field:'uSessionSummaryNotableCount',header:'Notable Count'},{field:'uSessionSummaryNotablePerDay',header:'Notable Per Day (Average)'}];this.pRuleTuningDynamicColumns=this.pRuleTuningColumns.map((col,i)=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:col.field,header:col.header,sortable:true},col.field,false,{fileName:_jsxFileName,lineNumber:439,columnNumber:14},this);});this.pRuleTuningSettings={columns:{date:{title:'Date Run'},daysQueried:{title:'Days Queried'},riskScore:{title:'Min Risk Score'},type:{title:'Session Type'},uSessionSummaryRiskScore:{title:'Session Scores'},uSessionSummarySessionCount:{title:'Session Count'},uSessionSummaryNotableCount:{title:'Notable Count'},uSessionSummaryNotablePerDay:{title:'Notable Per Day (Average)'}}};this.pDataValidationColumns=[{field:'date',header:'Date Run'},{field:'daysQueried',header:'Days Queried'}];this.pDataValidationDynamicColumns=this.pDataValidationColumns.map((col,i)=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:col.field,header:col.header,sortable:true},col.field,false,{fileName:_jsxFileName,lineNumber:460,columnNumber:14},this);});this.showHome=true;}getNotables(type){this.arrayType=type;this.showLogin=false;this.showHome=false;this.loading=true;this.showTuning=true;//Threat Hunter query for all sessions that with risk score >= 90 over 7 days
chrome.tabs.sendMessage(this.tabID,{message:"notableSearch",queryUnit:this.queryUnit,queryUnitNum:this.queryUnitNum,queryRiskScore:this.queryRiskScore,queryLimit:this.queryLimit},response=>{//console.log('noatble response = ',response);
this.thResults=response;this.fixArray();});}fixArray(){console.log('fixArray() running');console.log('this.arrayType = ',this.arrayType);this.forEachBreak=false;this.counter=0;this.thResultsUsers={};this.thResultsUsers.sessions=[];this.thResultsUsers.userCounts=[];this.thResultsUsers.ruleCounts=[];this.thResultsAssets={};this.thResultsAssets.sessions=[];this.thResultsAssets.userCounts=[];this.thResultsAssets.ruleCounts=[];this.doneCountSessions=0;this.doneCountTimelines=0;//Grab all the session IDs from the TH query and put them in a new array
if(this.arrayType==='asset'&&typeof this.thResults.entities.asset!=='undefined'){for(this.index=0;this.index<this.thResults.entities.asset.length;this.index++){this.thResultsUsers.sessions[this.index]={};this.thResultsUsers.sessions[this.index].id=this.thResults.entities.asset[this.index].assetSequenceInfo.assetSequenceId;this.thResultsUsers.sessions[this.index].user=this.thResults.entities.asset[this.index].assetSequenceInfo.assetId;this.thResultsUsers.sessions[this.index].riskScore=this.thResults.entities.asset[this.index].assetSequenceInfo.riskScore;}this.getSequences(0);}if(this.arrayType==='session'&&typeof this.thResults.entities.session!=='undefined'){for(this.index=0;this.index<this.thResults.entities.session.length;this.index++){this.thResultsUsers.sessions[this.index]={};this.thResultsUsers.sessions[this.index].id=this.thResults.entities.session[this.index].sessionInfo.sessionId;this.thResultsUsers.sessions[this.index].user=this.thResults.entities.session[this.index].sessionInfo.username;this.thResultsUsers.sessions[this.index].riskScore=this.thResults.entities.session[this.index].sessionInfo.riskScore;}this.getSessions(0);}//Take all of those session IDs and get all the triggered rules and their underlying events, add them to the array
}getSessions(offset){this.visibleTuningProgress=true;var counter=0;if(offset!=0){var tempIndex=offset*this.allowedCount;}else{var tempIndex=0;}var maxIndex=tempIndex+this.allowedCount;var tempKeys=[];var tempArray=[];this.thResultsUsers.sessions.forEach((obj,index)=>{tempKeys.push(obj.id);});for(var a=tempIndex;a<maxIndex;a++){tempArray.push(tempKeys[a]);}this.todoTimelines=tempKeys.length;//Start loop of fetch
tempArray.forEach((obj,index)=>{if(obj!=undefined){axios_default()('https://'+this.host+'/uba/api/user/sequence/triggeredRules?sequenceType=session&sequenceId='+obj,{method:'GET',withCredentials:'include'}).then(response=>{//console.log('got response of timeline and it is = ',response);
this.thResultsUsers.sessions.forEach((obj2,index2)=>{//console.log('obj(',obj,') && obj2.id(',obj2.id,')');
if(obj===obj2.id){//console.log('matches!')
obj2.rules=response.data;//console.log('counter BEFORE = ', counter);
counter=counter+1;//console.log('counter AFTER = ', counter);
this.doneCountSessions=this.doneCountSessions+1;//console.log('this.doneCountTimelines BEFORE = ', this.doneCountTimelines);
this.doneCountTimelines++;//console.log('this.doneCountTimelines AFTER = ', this.doneCountTimelines);
this.tuningProgress=Math.round(this.doneCountTimelines/this.todoTimelines*100);if(counter<this.allowedCount){//  console.log('Index = '+b+' this.activeCount LESSER this.allowedCount');
}else{//  console.log('Index = '+b+' this.activeCount GREATER this.allowedCount');
if(this.doneCountSessions<=tempKeys.length)this.getSessions(offset+1);}if(this.doneCountSessions===tempKeys.length){this.arraySum(this.thResultsUsers);}}});//  console.log(response);
}).catch(error=>{//  console.log(error);
});}});}getSequences(offset){this.visibleTuningProgress=true;var counter=0;if(offset!=0){var tempIndex=offset*this.allowedCount;}else{var tempIndex=0;}var maxIndex=tempIndex+this.allowedCount;var tempKeys=[];var tempArray=[];this.thResultsUsers.sessions.forEach((obj,index)=>{tempKeys.push(obj.id);});for(var a=tempIndex;a<maxIndex;a++){tempArray.push(tempKeys[a]);}this.todoTimelines=tempKeys.length;//Start loop of fetch
tempArray.forEach((obj,index)=>{if(obj!=undefined){axios_default()('https://'+this.host+'/uba/api/asset/sequence/'+obj+'/triggeredRules',{method:'GET',withCredentials:'include'}).then(response=>{this.thResultsUsers.sessions.forEach((obj2,index2)=>{if(obj===obj2.id){obj2.rules=response.data;counter=counter+1;this.doneCountSessions=this.doneCountSessions+1;this.doneCountTimelines++;this.tuningProgress=Math.round(this.doneCountTimelines/this.todoTimelines*100);if(counter<this.allowedCount){//  console.log('Index = '+b+' this.activeCount LESSER this.allowedCount');
}else{//  console.log('Index = '+b+' this.activeCount GREATER this.allowedCount');
if(this.doneCountSessions<=tempKeys.length)this.getSequences(offset+1);}if(this.doneCountSessions===tempKeys.length){this.arraySum(this.thResultsUsers);}}});//  console.log(response);
}).catch(error=>{// console.log(error);
});}});}arraySum(sessionData){console.log('sessionData before modification = ',sessionData);//Setup array to count what users have triggered sessions and their total scores
//console.log('about to start');
sessionData.sessions.forEach((obj,index)=>{//console.log('in my new loop on index '+index);
if(sessionData.userCounts.some(username=>username.user===sessionData.sessions[index].user)){//  console.log( "Object found inside the array.");
}else{//  console.log("Object not found.");
//  console.log('pushing '+sessionData.sessions[index].user);
sessionData.userCounts.push({'user':sessionData.sessions[index].user,'count':0,'totalScore':0});}});//Add up the amount of times a user was seen and sum up the total risk score of those sessions
for(var i=0;i<sessionData.sessions.length;i++){for(var b=0;b<sessionData.userCounts.length;b++){if(sessionData.sessions[i].user===sessionData.userCounts[b].user){sessionData.userCounts[b].count=sessionData.userCounts[b].count+1;sessionData.userCounts[b].totalScore=sessionData.userCounts[b].totalScore+sessionData.sessions[i].riskScore;}}}//Sum up user session info
this.uSessionSummaryNotableCount=0;this.uSessionSummaryRiskScore=0;this.uSessionSummaryCount=sessionData.sessions.length;for(var i=0;i<sessionData.sessions.length;i++){if(sessionData.sessions[i].riskScore>=90)this.uSessionSummaryNotableCount=this.uSessionSummaryNotableCount+1;this.uSessionSummaryRiskScore=this.uSessionSummaryRiskScore+sessionData.sessions[i].riskScore;}this.uSessionSummaryNotablePerDay=Math.round(this.uSessionSummaryNotableCount/this.queryUnitNum);this.uSessionSummarySessionCount=sessionData.sessions.length;//Setup array to count what rules have triggered and their total scores
//console.log('about to start rules');
sessionData.sessions.forEach((obj,index)=>{sessionData.sessions[index].rules.triggeredRules.forEach((obj2,index2)=>{sessionData.sessions[index].rules.triggeredRules[index2].ruleName=sessionData.sessions[index].rules.rules[sessionData.sessions[index].rules.triggeredRules[index2].ruleId].ruleName;if(sessionData.ruleCounts.some(ruleName=>ruleName.rule===sessionData.sessions[index].rules.triggeredRules[index2].ruleId)){//   console.log( sessionData.sessions[index].rules.triggeredRules[index2].ruleId +" found inside the array.");
}else{//console.log(sessionData.sessions[index].rules.triggeredRules[index2].ruleId+" not found.");
//  console.log('index = '+index);
// console.log('index2 = '+index2);
sessionData.ruleCounts.push({'rule':sessionData.sessions[index].rules.triggeredRules[index2].ruleId,'ruleName':sessionData.sessions[index].rules.triggeredRules[index2].ruleName,'count':0,'sessionCount':0,'originalSessionCount':0,'sessionIDs':[],'totalScore':0,'ruleDef':sessionData.sessions[index].rules.rules[sessionData.sessions[index].rules.triggeredRules[index2].ruleId]});}});});//Add empty array of events under each triggered rule
for(var b=0;b<sessionData.ruleCounts.length;b++){sessionData.ruleCounts[b].events=[];}//Fill in event details for each event triggered under a rule
sessionData.sessions.forEach((obj,index)=>{sessionData.sessions[index].rules.triggeredRules.forEach((obj2,index2)=>{sessionData.ruleCounts.forEach((obj3,index3)=>{if(sessionData.sessions[index].rules.triggeredRules[index2].ruleId===sessionData.ruleCounts[index3].rule){if(sessionData.ruleCounts[index3].events.some(eventObject=>eventObject.eventId===sessionData.sessions[index].rules.triggeredRules[index2].eventId)){//  console.log( sessionData.sessions[index].rules.triggeredRules[index2].eventId +" found inside the array.");
}else{//   console.log(sessionData.sessions[index].rules.triggeredRules[index2].eventId+" not found.");
Object.keys(sessionData.sessions[index].rules.triggeredRuleEvents).forEach((obj4,index4)=>{if(obj4===sessionData.sessions[index].rules.triggeredRules[index2].eventId){if(sessionData.sessions[index].rules.triggeredRuleEvents[obj4].fields['riskScore-'+sessionData.sessions[index].rules.triggeredRules[index2].ruleId]==undefined)sessionData.sessions[index].rules.triggeredRuleEvents[obj4].fields['riskScore-'+sessionData.sessions[index].rules.triggeredRules[index2].ruleId]=0;sessionData.sessions[index].rules.triggeredRuleEvents[obj4].fields.origSessionId=sessionData.sessions[index].id;sessionData.sessions[index].rules.triggeredRuleEvents[obj4].fields['riskScore-'+sessionData.sessions[index].rules.triggeredRules[index2].ruleId]=sessionData.sessions[index].rules.triggeredRuleEvents[obj4].fields['riskScore-'+sessionData.sessions[index].rules.triggeredRules[index2].ruleId]+Math.round(sessionData.sessions[index].rules.triggeredRules[index2].riskScore);sessionData.ruleCounts[index3].events.push(sessionData.sessions[index].rules.triggeredRuleEvents[""+obj4].fields);}});}}});});});//Add up the amount of times a rule was seen and sum up the total risk score of those rules
for(var i=0;i<sessionData.sessions.length;i++){for(var a=0;a<sessionData.sessions[i].rules.triggeredRules.length;a++){for(var b=0;b<sessionData.ruleCounts.length;b++){if(sessionData.sessions[i].rules.triggeredRules[a].ruleId===sessionData.ruleCounts[b].rule){sessionData.ruleCounts[b].originalCount=sessionData.ruleCounts[b].count+1;sessionData.ruleCounts[b].count=sessionData.ruleCounts[b].count+1;sessionData.ruleCounts[b].originalTotalScore=sessionData.ruleCounts[b].totalScore+Math.round(sessionData.sessions[i].rules.triggeredRules[a].riskScore);sessionData.ruleCounts[b].totalScore=sessionData.ruleCounts[b].totalScore+Math.round(sessionData.sessions[i].rules.triggeredRules[a].riskScore);if(this.uSessionSummaryTunedRiskScore){sessionData.ruleCounts[b].totalScorePercent=Math.round(sessionData.ruleCounts[b].totalScore/this.uSessionSummaryTunedRiskScore*100);}else{sessionData.ruleCounts[b].totalScorePercent=Math.round(sessionData.ruleCounts[b].totalScore/this.uSessionSummaryRiskScore*100);}}}}}for(var b=0;b<sessionData.ruleCounts.length;b++){for(var i=0;i<sessionData.sessions.length;i++){if(sessionData.sessions[i].rules.triggeredRules.some(rule=>rule.ruleId===sessionData.ruleCounts[b].rule)){sessionData.ruleCounts[b].originalSessionCount=sessionData.ruleCounts[b].originalSessionCount+1;sessionData.ruleCounts[b].sessionIDs.push(sessionData.sessions[i].id);sessionData.ruleCounts[b].sessionCount=sessionData.ruleCounts[b].sessionCount+1;if(this.uSessionSummaryTunedRiskScore){sessionData.ruleCounts[b].sessionCountPercent=Math.round(sessionData.ruleCounts[b].sessionCount/this.uSessionSummaryTunedNotablePerDay*100);}else{sessionData.ruleCounts[b].sessionCountPercent=Math.round(sessionData.ruleCounts[b].sessionCount/this.uSessionSummarySessionCount*100);}}}}if(!this.onPreviousSession)this.storeTuningSession();this.setTuningData(sessionData.userCounts,sessionData.ruleCounts);}setTuningData(userCounts,ruleCounts){this.userData=userCounts;this.ruleData=ruleCounts;// console.log('this.ruleData = ',this.ruleData);
this.ruleTuning=[];this.bannedEvents=[];this.loading=false;this.visibleTuningProgress=false;this.columns1=[{field:'user',header:'User'},{field:'count',header:'Session Count'},{field:'totalScore',header:'Total Score'}];this.userDataDynamicColumns=this.columns1.map((col,i)=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:col.field,header:col.header,sortable:true},col.field,false,{fileName:_jsxFileName,lineNumber:767,columnNumber:14},this);});this.columns2=[{field:'rule',header:'Rule ID'},{field:'ruleName',header:'Rule Name'},{field:'count',header:'Rule Count'},{field:'sessionCount',header:'Session Count'},{field:'totalScore',header:'Total Score'}];this.columns4=[{field:'fieldName',header:'Field Name'},{field:'fieldValue',header:'Value'},{field:'count',header:'Event Count'},{field:'sessionCount',header:'Session Count'},{field:'totalScore',header:'Total Score'}];this.columns5=[{field:'name',header:'Name'},{field:'value',header:'Value'},{field:'count',header:'Rule Count'},{field:'score',header:'Score'}];this.ruleTuningDynamicColumns=this.columns5.map((col,i)=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:col.field,header:col.header,sortable:true},col.field,false,{fileName:_jsxFileName,lineNumber:794,columnNumber:14},this);});this.showTuning=false;this.showTuning=true;this.loading=false;}async storeTuningSession(){var db=new dexie["a" /* default */](this.dbName);db.version(1).stores(this.dbStores);await db.table(this.ruleTuningDb).add({date:Date.now(),type:this.arrayType,daysQueried:this.queryUnitNum,riskScore:this.queryRiskScore,sessionData:this.thResultsUsers,uSessionSummaryRiskScore:this.uSessionSummaryRiskScore,uSessionSummarySessionCount:this.uSessionSummarySessionCount,uSessionSummaryNotableCount:this.uSessionSummaryNotableCount,uSessionSummaryNotablePerDay:this.uSessionSummaryNotablePerDay});console.log('just inserted and now this.db.ruleTuning.toArray() = ',await db.table(this.ruleTuningDb).toArray());}async storeValidationSession(){var db=new dexie["a" /* default */](this.dbName);db.version(1).stores(this.dbStores);if(this.onPreviousSession){// console.log('on previous session, will attempt to put');
// console.log('data to be inserted:');
// console.log('this.selectedSession.id= ',this.selectedSession.id);
// console.log('this.selectedSession.epochDate= ',this.selectedSession.epochDate);
// console.log('this.selectedSession.daysQueried= ',this.selectedSession.daysQueried);
// console.log('this.rulesAndModels= ',this.rulesAndModels);
// console.log('this.eventTypes= ',this.eventTypes);
// console.log('this.summary= ',this.summary);
// console.log('this.sources= ',this.sources);
await db.table(this.dataValidationDb).put({id:this.selectedSession.id,date:this.selectedSession.epochDate,daysQueried:this.selectedSession.daysQueried,rulesAndModels:this.rulesAndModels,eventTypes:this.eventTypes,summary:this.summary,sources:this.sources});}else{console.log('not on previous session, will attempt to add');await db.table(this.dataValidationDb).add({date:Date.now(),daysQueried:this.queryUnitNum,rulesAndModels:this.rulesAndModels,eventTypes:this.eventTypes,summary:this.summary,sources:this.sources});}console.log('just inserted and now this.db.dataValidation.toArray() = ',await db.table(this.dataValidationDb).toArray());this.loading=false;}async delTuningSession(id){var db=new dexie["a" /* default */](this.dbName);db.version(1).stores(this.dbStores);await db.table(this.ruleTuningDb).delete(id);this.getDB();}async delDataValidation(id){var db=new dexie["a" /* default */](this.dbName);db.version(1).stores(this.dbStores);await db.table(this.dataValidationDb).delete(id);this.getDB();}async selTuningSession(rowData){var db=new dexie["a" /* default */](this.dbName);db.version(1).stores(this.dbStores);this.selectedSession=await db.table(this.ruleTuningDb).where({id:rowData.id}).toArray();this.selectedSession=this.selectedSession[0];this.onSessionSelect();}onSessionSelect(){this.onPreviousSession=true;this.thResultsUsers=this.selectedSession.sessionData;this.uSessionSummaryRiskScore=this.selectedSession.uSessionSummaryRiskScore;this.uSessionSummarySessionCount=this.selectedSession.uSessionSummarySessionCount;this.uSessionSummaryNotableCount=this.selectedSession.uSessionSummaryNotableCount;this.uSessionSummaryNotablePerDay=this.selectedSession.uSessionSummaryNotablePerDay;this.showHome=false;this.showTuning=true;this.setTuningData(this.selectedSession.sessionData.userCounts,this.selectedSession.sessionData.ruleCounts);}async selDvSession(rowData){var db=new dexie["a" /* default */](this.dbName);db.version(1).stores(this.dbStores);this.selectedSession=await db.table(this.dataValidationDb).where({id:rowData.id}).toArray();this.selectedSession=this.selectedSession[0];this.onDvSessionSelect();}onDvSessionSelect(){this.onPreviousSession=true;this.rulesAndModels=this.selectedSession.rulesAndModels;this.rulesAndModelsDone=this.selectedSession.rulesAndModels;this.eventTypes=this.selectedSession.eventTypes;this.eventTypesDone=this.eventTypes;this.summary=this.selectedSession.summary;this.showHome=false;this.showValidation=true;this.getRawEvents(0,0);//this.findRequiredData(this.rulesAndModels);
}delPreviousRuleTuning(session){console.log('selected data to delete = ',session);this.delTuningSession(session.id);}delPreviousDataValidation(session){console.log('selected data to delete = ',session);this.delDataValidation(session.id);}onSourceSelect(sessionEvents,assetEvents,sessionHeader,assetHeader){this.selectedSourceSessionEvents=[];this.selectedSourceAssetEvents=[];this.sessionHeader=sessionHeader;this.assetHeader=assetHeader;sessionEvents.forEach(obj=>{this.selectedSourceSessionEvents.push(obj);});assetEvents.forEach(obj=>{this.selectedSourceAssetEvents.push(obj);});this.visibleSelectedSource=true;}onRowSelect(event){this.selectedRule=event.rule;this.selectedRuleCount=event.count;this.selectedRuleScore=event.totalScore;this.selectedRuleSessionCount=event.sessionCount;console.log('selected rule = ',event.rule);this.showTuning=false;this.showEvents=true;this.loading=true;this.setEvents(event.rule);}toggleShowEvents(){this.showEvents=false;this.showTuning=true;}toggleShowHome(){this.uSessionSummaryTunedRiskScore=null;this.uSessionSummaryTunedNotableCount=null;this.uSessionSummaryTunedNotablePerDay=null;this.uSessionSummaryTunedRiskScorePercent=null;this.uSessionSummaryTunedNotableCountPercent=null;this.uSessionSummaryTunedNotablePerDayPercent=null;this.allRules=null;this.allModels=null;this.summary={};this.summary.uniqueUsers=[];this.summary.uniqueHosts=[];this.summary.uniqueIPs=[];this.summary.uniqueUserCount=0;this.summary.uniqueHostCount=0;this.summary.uniqueIPsCount=0;this.sources=[];this.userData=[];this.ruleData=[];this.doneEventTypes=[];this.doneEventTypeSessions=[];this.doneEventTypeAssets=[];this.doneEventTypeSessionsDetails=[];this.doneEventTypeAssetsDetails=[];this.doneRawEvents=[];this.todoRawEventsCount=0;this.doneRawEventsCount=0;this.validDoneRawEventsCount=0;this.retryAttemptRawEventsCount=0;this.getDB();this.showTuning=false;this.showValidation=false;this.onPreviousSession=false;this.showpRuleTuning=true;this.showHome=true;}setEvents(ruleName){this.tempCount=0;this.showTuning=false;this.showEvents=true;this.eventData=[];this.eventSummaryData=[];this.eventSummaryData2={};for(var i=0;i<this.thResultsUsers.ruleCounts.length;i++){if(this.thResultsUsers.ruleCounts[i].rule===ruleName){this.eventData=this.thResultsUsers.ruleCounts[i].events;this.eventData.forEach(obj=>{if(this.bannedEvents.some(theEvent=>theEvent.event_id===obj.event_id)){this.bannedEvents.forEach((obj3,index3)=>{if(obj3.event_id===obj.event_id){if(obj3.rules.some(theRule=>theRule===ruleName)){}else{Object.keys(obj).forEach(obj2=>{if(obj2!='time'&&obj2!='rawlog_time'&&obj2!='session_order'&&obj2!='event_id'&&obj2!='alert_id'&&obj2!='riskScore'&&obj2!='is_session_last'&&obj2!='rawlog_refs'&&obj2.substring(0,obj2.indexOf('-'))!='riskScore'&&obj[obj2]!=''){if(typeof this.eventSummaryData2[obj2.concat('-',obj[obj2])]==='undefined'){this.eventSummaryData2[obj2.concat('-',obj[obj2])]={};this.eventSummaryData2[obj2.concat('-',obj[obj2])].fieldName=obj2;this.eventSummaryData2[obj2.concat('-',obj[obj2])].fieldValue=obj[obj2];this.eventSummaryData2[obj2.concat('-',obj[obj2])].count=1;this.eventSummaryData2[obj2.concat('-',obj[obj2])].totalScore=obj['riskScore-'+this.selectedRule];this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCount=0;this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionIds=[];if(this.thResultsUsers.ruleCounts[i].sessionIDs.some(id=>id===obj.origSessionId)){this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionIds.push(obj.origSessionId);this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCount++;}this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCountPercent=Math.round(this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCount/this.selectedRuleSessionCount*100);}else{this.eventSummaryData2[obj2.concat('-',obj[obj2])].count++;this.eventSummaryData2[obj2.concat('-',obj[obj2])].totalScore=this.eventSummaryData2[obj2.concat('-',obj[obj2])].totalScore+obj['riskScore-'+this.selectedRule];this.eventSummaryData2[obj2.concat('-',obj[obj2])].countPercent=Math.round(this.eventSummaryData2[obj2.concat('-',obj[obj2])].count/this.selectedRuleCount*100);this.eventSummaryData2[obj2.concat('-',obj[obj2])].totalScorePercent=Math.round(this.eventSummaryData2[obj2.concat('-',obj[obj2])].totalScore/this.selectedRuleScore*100);if(this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionIds.some(id=>id===obj.origSessionId)){}else{if(this.thResultsUsers.ruleCounts[i].sessionIDs.some(id=>id===obj.origSessionId)){this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionIds.push(obj.origSessionId);this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCount++;this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCountPercent=Math.round(this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCount/this.selectedRuleSessionCount*100);}}}}});}}});}else{Object.keys(obj).forEach(obj2=>{if(obj2!='time'&&obj2!='rawlog_time'&&obj2!='session_order'&&obj2!='event_id'&&obj2!='alert_id'&&obj2!='riskScore'&&obj2!='is_session_last'&&obj2!='rawlog_refs'&&obj2.substring(0,obj2.indexOf('-'))!='riskScore'&&obj[obj2]!=''){if(typeof this.eventSummaryData2[obj2.concat('-',obj[obj2])]==='undefined'){this.eventSummaryData2[obj2.concat('-',obj[obj2])]={};this.eventSummaryData2[obj2.concat('-',obj[obj2])].fieldName=obj2;this.eventSummaryData2[obj2.concat('-',obj[obj2])].fieldValue=obj[obj2];this.eventSummaryData2[obj2.concat('-',obj[obj2])].count=1;this.eventSummaryData2[obj2.concat('-',obj[obj2])].totalScore=obj['riskScore-'+this.selectedRule];this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCount=0;this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionIds=[];if(this.thResultsUsers.ruleCounts[i].sessionIDs.some(id=>id===obj.origSessionId)){this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionIds.push(obj.origSessionId);this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCount++;}this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCountPercent=Math.round(this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCount/this.selectedRuleSessionCount*100);}else{this.eventSummaryData2[obj2.concat('-',obj[obj2])].count++;this.eventSummaryData2[obj2.concat('-',obj[obj2])].totalScore=this.eventSummaryData2[obj2.concat('-',obj[obj2])].totalScore+obj['riskScore-'+this.selectedRule];this.eventSummaryData2[obj2.concat('-',obj[obj2])].countPercent=Math.round(this.eventSummaryData2[obj2.concat('-',obj[obj2])].count/this.selectedRuleCount*100);this.eventSummaryData2[obj2.concat('-',obj[obj2])].totalScorePercent=Math.round(this.eventSummaryData2[obj2.concat('-',obj[obj2])].totalScore/this.selectedRuleScore*100);if(this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionIds.some(id=>id===obj.origSessionId)){}else{if(this.thResultsUsers.ruleCounts[i].sessionIDs.some(id=>id===obj.origSessionId)){this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionIds.push(obj.origSessionId);this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCount++;this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCountPercent=Math.round(this.eventSummaryData2[obj2.concat('-',obj[obj2])].sessionCount/this.selectedRuleSessionCount*100);}}}}});}});}}// console.log('this.eventSummaryData.length BEFORE = ',this.eventSummaryData.length);
// console.log('this.eventSummaryData BEFORE = ',this.eventSummaryData);
// console.log('Object.keys(this.eventSummaryData2).length = ',Object.keys(this.eventSummaryData2).length);
// console.log('this.eventSummaryData2 = ',this.eventSummaryData2);
this.eventSummaryData=Object.values(this.eventSummaryData2);this.eventSummaryData2=[];// console.log('this.eventSummaryData.length AFTER = ',this.eventSummaryData.length);
// console.log('this.eventSummaryData AFTER = ',this.eventSummaryData);
// for (var i=0; i < this.eventData.length; i++) {
//   Object.keys(this.eventData[i]).forEach((obj2, index2) => {
//     for (var b=0; b < this.eventSummaryData.length; b++) {
//       if(this.eventSummaryData[b].fieldName === obj2 && this.eventSummaryData[b].fieldValue === this.eventData[i][obj2] && this.eventData[i]['riskScore-'+this.selectedRule]) {
//         if(this.bannedEvents.some(theEvent => theEvent.event_id === this.eventData[i].event_id)) {
//           this.bannedEvents.forEach((obj3, index3) => {
//             if(obj3.event_id === this.eventData[i].event_id){
//               if(obj3.rules.some(theRule => theRule === ruleName)){           
//               } else {
//                 this.eventSummaryData[b].count = this.eventSummaryData[b].count + 1;
//                 this.eventSummaryData[b].totalScore = this.eventSummaryData[b].totalScore + this.eventData[i]['riskScore-'+this.selectedRule];
//                 this.eventSummaryData[b].countPercent = Math.round(((this.eventSummaryData[b].count / this.selectedRuleCount))*100);
//                 this.eventSummaryData[b].totalScorePercent = Math.round(((this.eventSummaryData[b].totalScore / this.selectedRuleScore))*100);                   
//                 if(this.eventSummaryData[b].sessionIds.some(id => id === this.eventData[i].session_id)) {
//                 } else {
//                   this.eventSummaryData[b].sessionIds.push(this.eventData[i].session_id);
//                   this.eventSummaryData[b].sessionCount = this.eventSummaryData[b].sessionCount + 1;
//                   this.eventSummaryData[b].sessionCountPercent = Math.round(((this.eventSummaryData[b].sessionCount / this.selectedRuleSessionCount))*100);
//                 }                    
//               }
//             }
//           })
//         } else {
//           this.eventSummaryData[b].count = this.eventSummaryData[b].count + 1;
//           this.eventSummaryData[b].totalScore = this.eventSummaryData[b].totalScore + this.eventData[i]['riskScore-'+this.selectedRule];
//           this.eventSummaryData[b].countPercent = Math.round(((this.eventSummaryData[b].count / this.selectedRuleCount))*100);
//           this.eventSummaryData[b].totalScorePercent = Math.round(((this.eventSummaryData[b].totalScore / this.selectedRuleScore))*100); 
//           if(this.eventSummaryData[b].sessionIds.some(id => id === this.eventData[i].session_id)) {
//           } else {
//             this.eventSummaryData[b].sessionIds.push(this.eventData[i].session_id);
//             this.eventSummaryData[b].sessionCount = this.eventSummaryData[b].sessionCount + 1;
//             this.eventSummaryData[b].sessionCountPercent = Math.round(((this.eventSummaryData[b].sessionCount / this.selectedRuleSessionCount))*100);
//           }
//         }            
//       }          
//     }      
//   })       
// }
this.eventSummaryDataDone=this.eventSummaryData;this.eventSummaryData=[];this.loading=false;}tuneRule(data){this.foundRule=false;//Add rule tuning conditions to array
if(this.ruleTuning.length==0){this.ruleTuning.push({'data':{'name':this.selectedRule,'value':'','count':'','score':'','sessionCount':''},'children':[]});this.ruleTuning[0].children.push({'data':{'name':data.fieldName,'value':data.fieldValue,'count':data.count,'score':data.totalScore,'sessionCount':data.sessionCount,'scorePercent':Math.round(data.totalScore/this.uSessionSummaryRiskScore*100)}});}else{this.ruleTuning.forEach((obj,index)=>{if(obj.data.name===this.selectedRule){this.foundRule=true;if(obj.children.some(theEvent=>theEvent.data.name===data.fieldName&&theEvent.data.value===data.fieldValue)){}else{obj.children.push({'data':{'name':data.fieldName,'value':data.fieldValue,'count':data.count,'score':data.totalScore,'sessionCount':data.sessionCount,'scorePercent':Math.round(data.totalScore/this.uSessionSummaryRiskScore*100)}});}}});if(this.foundRule==false){this.ruleTuning.push({'data':{'name':this.selectedRule,'value':'','count':'','score':'','sessionCount':''},'children':[{'data':{'name':data.fieldName,'value':data.fieldValue,'count':data.count,'score':data.totalScore,'sessionCount':data.sessionCount,'scorePercent':Math.round(data.totalScore/this.uSessionSummaryRiskScore*100)}}]});}}//Go back through tuned rules and sum up changes per rule
this.ruleTuning.forEach((obj,index)=>{obj.data.count=0;obj.data.score=0;obj.data.sessionCount=0;obj.children.forEach((obj2,index2)=>{obj.data.count=obj.data.count+obj2.data.count;obj.data.score=obj.data.score+obj2.data.score;obj.data.sessionCount=obj.data.sessionCount+obj2.data.sessionCount;});});//Apply changes to rule counts
for(var b=0;b<this.thResultsUsers.ruleCounts.length;b++){this.ruleTuning.forEach((obj,index)=>{if(obj.data.name===this.thResultsUsers.ruleCounts[b].rule){this.thResultsUsers.ruleCounts[b].count=this.thResultsUsers.ruleCounts[b].originalCount-obj.data.count;this.thResultsUsers.ruleCounts[b].totalScore=this.thResultsUsers.ruleCounts[b].originalTotalScore-obj.data.score;this.thResultsUsers.ruleCounts[b].sessionCount=this.thResultsUsers.ruleCounts[b].originalSessionCount-obj.data.sessionCount;if(obj.data.name===this.selectedRule){this.selectedRuleScore=this.thResultsUsers.ruleCounts[b].totalScore;this.selectedRuleCount=this.thResultsUsers.ruleCounts[b].count;this.selectedRuleSessionCount=this.thResultsUsers.ruleCounts[b].sessionCount;}}});}this.ruleData=this.thResultsUsers.ruleCounts;this.eventData.forEach((obj,index)=>{Object.keys(obj).forEach((obj2,index2)=>{if(data.fieldName===obj2&&data.fieldValue===obj[obj2]){if(this.bannedEvents.some(theEvent=>theEvent.event_id===obj.event_id)){this.bannedEvents.forEach((obj3,index3)=>{if(obj3.event_id===obj.event_id){if(obj3.rules.some(theRule=>theRule===this.selectedRule)){//console.log(this.selectedRule+ ' is already banned for event_id '+obj.event_id);         
}else{obj3.event_id[obj.event_id].rules.push(this.selectedRule);}}});}else{this.bannedEvents.push({'event_id':obj.event_id,'rules':[this.selectedRule]});}}});});//Test out rule exceptions on sessions
this.thResultsUsers.sessions.forEach((obj,index)=>{obj.riskScoreTuned=obj.riskScore;Object.keys(obj.rules.triggeredRuleEvents).forEach((obj2,index2)=>{if(this.bannedEvents.some(theEvent=>theEvent.event_id===obj2)){this.bannedEvents.forEach((obj3,index3)=>{if(obj3.event_id===obj2){obj3.rules.forEach((obj4,index4)=>{Object.keys(obj.rules.triggeredRuleEvents[obj2].fields).forEach((obj5,index4)=>{//console.log ('obj5 = '+obj5 + ' '+ obj5.substring(obj5.indexOf('-') + 1));
if(obj3.rules.some(theRule=>theRule===obj5.substring(obj5.indexOf('-')+1))){//console.log('found one at index '+ index);
//console.log('subtracting '+obj.rules.triggeredRuleEvents[obj2].fields[obj5]+ ' from '+obj.riskScoreTuned);
obj.riskScoreTuned=obj.riskScoreTuned-obj.rules.triggeredRuleEvents[obj2].fields[obj5];}});});}});}});});// Calculate results of rule exceptions on sessions
this.uSessionSummaryTunedNotableCount=0;this.uSessionSummaryTunedNotablePerDay=0;this.uSessionSummaryTunedRiskScore=0;this.uSessionSummaryTunedNotableCountPercent=0;this.uSessionSummaryTunedNotablePerDayPercent=0;this.uSessionSummaryTunedRiskScorePercent=0;for(var i=0;i<this.thResultsUsers.sessions.length;i++){if(this.thResultsUsers.sessions[i].riskScoreTuned>=90)this.uSessionSummaryTunedNotableCount=this.uSessionSummaryTunedNotableCount+1;this.uSessionSummaryTunedRiskScore=this.uSessionSummaryTunedRiskScore+this.thResultsUsers.sessions[i].riskScoreTuned;}this.uSessionSummaryTunedNotablePerDay=Math.round(this.uSessionSummaryTunedNotableCount/this.queryUnitNum);this.uSessionSummaryTunedNotableCountPercent=Math.round((this.uSessionSummaryTunedNotableCount/this.uSessionSummaryNotableCount-1)*100);this.uSessionSummaryTunedNotablePerDayPercent=Math.round((this.uSessionSummaryTunedNotablePerDay/this.uSessionSummaryNotablePerDay-1)*100);this.uSessionSummaryTunedRiskScorePercent=Math.round((this.uSessionSummaryTunedRiskScore/this.uSessionSummaryRiskScore-1)*100);//Reset user session score rollup and re-evaluate based on the tuned risk scores from sessions
this.thResultsUsers.userCounts.forEach((obj,index)=>{obj.totalScore=0;});for(var i=0;i<this.thResultsUsers.sessions.length;i++){for(var b=0;b<this.thResultsUsers.userCounts.length;b++){if(this.thResultsUsers.sessions[i].user===this.thResultsUsers.userCounts[b].user){this.thResultsUsers.userCounts[b].totalScore=this.thResultsUsers.userCounts[b].totalScore+this.thResultsUsers.sessions[i].riskScoreTuned;}}}this.userData=this.thResultsUsers.userCounts;//re-calcualte results of rule exceptions on event data
this.setEvents(this.selectedRule);}startValidation(){this.showValidation=true;this.loading=true;this.showLogin=false;this.showHome=false;this.visibleDataValidationProgress=true;//Get all rules
axios_default()('https://'+this.host+'/uba/api/rules/fetchRules?filterBy=all',{method:'GET',withCredentials:'include'}).then(response=>{this.allRules=response.data;this.allRules.forEach((obj,index)=>{obj.rules.forEach((obj2,index)=>{if(obj2.ruleDef.modelName==='FACT'){obj2.canTrigger='N/A';}else{obj2.canTrigger=false;}obj2.hasTriggered=false;});});this.getModels();}).catch(error=>{console.log('error');console.log(error);this.errors.push('Error fetching all rules');this.errorVisible=true;alert('ERROR fetching data: Check your URL and authenticaiton details and try again');});}getModels(){//Get all models
axios_default()('https://'+this.host+'/uba/api/rules/modelDefinitions',{method:'GET',withCredentials:'include'}).then(response=>{this.allModels=response.data;//console.log(response);
Object.keys(this.allModels).forEach((obj,index)=>{this.allModels[obj].populating=false;this.allModels[obj].attributes.populating=false;});this.checkModels(0);}).catch(error=>{console.log(error);this.errors.push('Error fetching all models');this.errorVisible=true;});}checkModels(offset){var counter=0;if(offset!=0){var tempIndex=offset*this.allowedCount;}else{var tempIndex=0;}var maxIndex=tempIndex+this.allowedCount;var tempKeys=Object.keys(this.allModels);this.todoModels=tempKeys.length;var tempArray=[];for(var b=tempIndex;b<maxIndex;b++){tempArray.push(tempKeys[b]);}tempArray.forEach((obj,index)=>{if(obj!=undefined){axios_default()('https://'+this.host+'/uba/api/histograms/search?maxNumberOfResults=1&modelName='+obj,{method:'GET',withCredentials:'include'}).then(response=>{//  console.log(response);
this.allModels[obj].histograms=response.data;if(this.allModels[obj].histograms.histograms.length!=0){this.allModels[obj].populating=true;this.allModels[obj].attributes.populating=true;}//  console.log('this index after = '+index);
counter=counter+1;this.doneCountModels=this.doneCountModels+1;this.dataValidationProgress=Math.round(this.doneCountModels/this.todoModels*20);if(counter<this.allowedCount){}else{if(this.doneCountModels<=tempKeys.length)this.checkModels(offset+1);}if(this.doneCountModels===tempKeys.length){console.log('moving to checkRules');this.checkRules(0);}}).catch(error=>{console.log(error);this.errors.push('Error fetching model: '+obj);this.errorVisible=true;counter=counter+1;this.doneCountModels=this.doneCountModels+1;if(counter<this.allowedCount){}else{if(this.doneCountModels<=tempKeys.length)this.checkModels(offset+1);}if(this.doneCountModels===tempKeys.length){console.log('moving to checkRules');this.checkRules(0);}});}});}checkRules(offset){var counter=0;if(offset!=0){var tempIndex=offset*this.allowedCount;}else{var tempIndex=0;}var maxIndex=tempIndex+this.allowedCount;var tempKeys=[];var tempArray=[];this.allRules.forEach((obj,index)=>{obj.rules.forEach((obj2,index2)=>{tempKeys.push(obj2.ruleId);});});this.todoRules=tempKeys.length;for(var a=tempIndex;a<maxIndex;a++){tempArray.push(tempKeys[a]);}//Check all rules if triggered
tempArray.forEach((obj,index)=>{axios_default()('https://'+this.host+'/uba/api/rules/triggerFrequency?ruleId='+obj,{method:'GET',withCredentials:'include'}).then(response=>{//  console.log(response);
this.allRules.forEach((obj2,index2)=>{obj2.rules.forEach((obj3,index3)=>{if(obj3.ruleId===obj){obj3.triggerFreq=response.data;if(obj3.triggerFreq.triggerFrequency===0){}else{obj3.hasTriggered=true;}}});});counter=counter+1;this.doneCountRules=this.doneCountRules+1;this.dataValidationProgress=Math.round(this.doneCountRules/this.todoRules*20+20);//console.log('Rules counter = '+counter);
//console.log('doneCountRules = '+this.doneCountRules);
//console.log('tempKeys.length = '+tempKeys.length);
if(counter<this.allowedCount){//  console.log('Index = '+b+' this.activeCount LESSER this.allowedCount');
}else{//  console.log('Index = '+b+' this.activeCount GREATER this.allowedCount');
if(this.doneCountRules<=tempKeys.length)this.checkRules(offset+1);}if(this.doneCountRules===tempKeys.length)this.combineArrays();}).catch(error=>{console.log(error);this.errors.push('Error fetching rule: '+obj);this.errorVisible=true;counter=counter+1;this.doneCountRules=this.doneCountRules+1;if(counter<this.allowedCount){//  console.log('Index = '+b+' this.activeCount LESSER this.allowedCount');
}else{//  console.log('Index = '+b+' this.activeCount GREATER this.allowedCount');
if(this.doneCountRules<=tempKeys.length)this.checkRules(offset+1);}if(this.doneCountRules===tempKeys.length)this.combineArrays();});});}combineArrays(){this.summary={};this.summary.uniqueUsers=[];this.summary.uniqueHosts=[];this.summary.uniqueIPs=[];this.summary.uniqueUserCount=0;this.summary.uniqueHostCount=0;this.summary.uniqueIPsCount=0;this.rulesAndModels=[];this.allRules.forEach((obj,index)=>{obj.rules.forEach((obj2,index2)=>{var ruleType;if(obj2.ruleDef.modelName==='FACT'){ruleType='FACT';}else{ruleType='Model';}if(this.allModels[obj2.ruleDef.modelName]==undefined){this.rulesAndModels.push({ruleCat:obj.categoryId,ruleId:obj2.ruleDef.ruleId,ruleName:obj2.ruleDef.ruleName,ruleType:ruleType,modelName:obj2.ruleDef.modelName,modelDisabled:'N/A',populating:'N/A',hasTriggered:obj2.hasTriggered.toString(),ruleDef:obj2.ruleDef});}else{this.rulesAndModels.push({ruleCat:obj.categoryId,ruleId:obj2.ruleDef.ruleId,ruleName:obj2.ruleDef.ruleName,ruleType:ruleType,modelName:obj2.ruleDef.modelName,modelDisabled:this.allModels[obj2.ruleDef.modelName].attributes.disabled,populating:this.allModels[obj2.ruleDef.modelName].populating.toString(),hasTriggered:obj2.hasTriggered.toString(),ruleDef:obj2.ruleDef,modelDef:this.allModels[obj2.ruleDef.modelName].attributes});}});});this.findRequiredData(this.rulesAndModels);}findRequiredData(rulesAndModels){rulesAndModels.forEach((obj,index)=>{var tempfield='';//If not a fact based rule, determine the event types required for model to trigger
if(obj.modelDef!=undefined){obj.modelDef.requiredEventFields=[];obj.modelDef.presentEventFields=[];obj.modelDef.missingEventFields=[];//If the feature has no parenthesis then just use a field name
if(obj.modelDef.feature.toLowerCase().startsWith('count')||obj.modelDef.feature.toLowerCase().startsWith('distinct')||obj.modelDef.feature.toLowerCase().startsWith('sum')||obj.modelDef.feature.toLowerCase().startsWith('sequence')){if(obj.modelDef.feature.toLowerCase().substring(obj.modelDef.feature.indexOf("(")+1).startsWith('getvalue(')){tempfield=obj.modelDef.feature.toLowerCase().substring(obj.modelDef.feature.indexOf("(")+1,obj.modelDef.feature.indexOf(")")+1).replace(/ /g,"");}else{tempfield=obj.modelDef.feature.toLowerCase().substring(obj.modelDef.feature.indexOf("(")+1,obj.modelDef.feature.indexOf(",")).replace(/ /g,"");}}else{tempfield=obj.modelDef.feature.toLowerCase().replace(/ /g,"");}if(obj.modelDef.requiredEventFields.some(field=>field===tempfield)){}else{obj.modelDef.requiredEventFields.push(tempfield);}if(obj.modelDef.trainIf.toLowerCase().startsWith('count')||obj.modelDef.trainIf.toLowerCase().startsWith('distinct')||obj.modelDef.trainIf.toLowerCase().startsWith('sum')||obj.modelDef.trainIf.toLowerCase().startsWith('sequence')){if(obj.modelDef.trainIf.toLowerCase().substring(obj.modelDef.trainIf.indexOf("(")+1).startsWith('getvalue(')){tempfield=obj.modelDef.trainIf.toLowerCase().substring(obj.modelDef.trainIf.indexOf("(")+1,obj.modelDef.trainIf.indexOf(")")+1).replace(/ /g,"");}else{tempfield=obj.modelDef.trainIf.toLowerCase().substring(obj.modelDef.trainIf.indexOf("(")+1,obj.modelDef.trainIf.indexOf(",")).replace(/ /g,"");}}if(obj.modelDef.requiredEventFields.some(field=>field===tempfield)){}else{obj.modelDef.requiredEventFields.push(tempfield);}if(obj.modelDef.trainIf.toLowerCase().includes('exists(')){tempfield=obj.modelDef.trainIf.toLowerCase().substring(obj.modelDef.trainIf.indexOf("exists(")+7,obj.modelDef.trainIf.indexOf(")",obj.modelDef.trainIf.indexOf("exists(")+7));if(obj.modelDef.requiredEventFields.some(field=>field===tempfield)){}else{obj.modelDef.requiredEventFields.push(tempfield);}}if(obj.modelDef.scopeType==='USER'||obj.modelDef.scopeType==='PEERS'||obj.modelDef.scopeType==='DEVICE'){tempfield=obj.modelDef.scopeValue.toLowerCase().replace(/ /g,"");if(obj.modelDef.requiredEventFields.some(field=>field===tempfield)){}else{obj.modelDef.requiredEventFields.push(tempfield);}}//If the model is trained by counting events at the end of the session or sequence then the true event types required are in the "Count" statement in the model's feature
if(obj.modelDef.histogramEventTypes.includes('session-end')||obj.modelDef.histogramEventTypes.includes('sequence-end')){obj.modelDef.requiredEventTypes=obj.modelDef.feature.substring(obj.modelDef.feature.indexOf(",")+1,obj.modelDef.feature.lastIndexOf(")")).replace(/ /g,"").split(",");for(var i=obj.modelDef.requiredEventTypes.length-1;i>=0;i--){if(obj.modelDef.requiredEventTypes[i].startsWith("'")&&obj.modelDef.requiredEventTypes[i].endsWith("'")&&obj.modelDef.requiredEventTypes[i].charAt(1).match(/[a-z]/)!=null){obj.modelDef.requiredEventTypes[i]=obj.modelDef.requiredEventTypes[i].replace(/'/g,"");}else{obj.modelDef.requiredEventTypes.splice(i,1);}}obj.ruleDef.requiredEvents=obj.modelDef.requiredEventTypes;//Otherwise we can simply use the "histogramEventTypes" field
}else{if(obj.modelDef.histogramEventTypes.includes(':')){obj.modelDef.requiredEventTypes=obj.modelDef.histogramEventTypes.split(":");obj.ruleDef.requiredEvents=obj.modelDef.requiredEventTypes;}else{obj.modelDef.requiredEventTypes=[];obj.modelDef.requiredEventTypes.push(obj.modelDef.histogramEventTypes);obj.ruleDef.requiredEvents=obj.modelDef.requiredEventTypes;}}}else{//If there is no model then use the rule definition field
obj.ruleDef.requiredEvents=obj.ruleDef.ruleEventTypes;}});if(this.onPreviousSession){this.bootstrapEventTypes();}else{this.getEventTypes();}}getEventTypes(){this.eventTypes=[];this.rulesAndModels.forEach((obj,index)=>{if(obj.populating!='N/A'){obj.ruleDef.requiredEvents.forEach((obj2,index2)=>{if(this.eventTypes.some(event=>event.name===obj2)){}else{this.eventTypes.push({name:obj2});}});}});this.getEventTypeSessions(0);}getEventTypeSessions(offset){// console.log('getting event types offset: '+offset);
var counter=0;var tempKeys=[];var tempArray=[];var tempAdded=0;this.eventTypes.forEach((obj,index)=>{tempKeys.push(obj);});this.todoEventTypes=tempKeys.length;for(var a=0;a<tempKeys.length&&tempAdded<=this.allowedEventTypeCount;a++){if(this.doneEventTypes.some(event=>event.name===tempKeys[a].name)){}else{//  console.log('pushing '+tempKeys[a].name+' to doneEventTypes');
tempArray.push(tempKeys[a]);this.doneEventTypes.push(tempKeys[a]);tempAdded++;}}//Check all event types if they exist
tempArray.forEach((obj,index)=>{if(obj!=undefined){// console.log('querying for '+obj.name);
this.activeEventTypes++;chrome.tabs.sendMessage(this.tabID,{message:"eventTypeSearch",eventType:obj,queryUnit:this.queryUnit,queryUnitNum:this.queryUnitNum,queryLimit:this.queryLimitDV},response=>{if(typeof response=='undefined'){console.log('response is undefined');this.errors.push('error fetching all session IDs for event type: '+obj.name+'. Trying again');this.errorVisible=true;for(var a=0;a<this.doneEventTypes.length;a++){if(this.doneEventTypes[a].name===obj.name)this.doneEventTypes.splice(a,1);}this.getEventTypeSessions(offset);}else{this.activeEventTypes--;this.eventTypes.forEach((obj2,index2)=>{if(obj.name===obj2.name){obj2.response=response;obj2.todoSessionIDs=[];obj2.todoAssetIDs=[];obj2.todoSessionEventIDs=[];obj2.todoAssetEventIDs=[];obj2.doneSessionIDs=[];obj2.doneAssetIDs=[];obj2.doneSessionEventIDs=[];obj2.doneAssetEventIDs=[];obj2.sessionEventDetails=[];obj2.sessionEventFields=[];obj2.assetEventDetails=[];obj2.assetEventFields=[];if(Object.keys(obj2.response.entities).length!=0){obj2.populating=true;}else{obj2.populating=false;}//console.log('counter BEFORE = ',counter);
counter=counter+1;//console.log('counter AFTER = ',counter);            
//console.log('counter: '+counter+' for offset: '+offset);
//console.log('tempKeys.length = ',tempKeys.length);
//console.log('this.doneCountEventTypes BEFORE = ',this.doneCountEventTypes);             
this.doneCountEventTypes=this.doneCountEventTypes+1;//console.log('this.doneCountEventTypes AFTER = ',this.doneCountEventTypes);
//console.log('this.dataValidationProgress BEFORE = ',this.dataValidationProgress);
this.dataValidationProgress=Math.round(this.doneCountEventTypes/this.todoEventTypes*20+40);//console.log('this.dataValidationProgress AFTER = ',this.dataValidationProgress);
if(counter===this.allowedEventTypeCount+1||this.todoEventTypes-this.doneCountEventTypes===0){offset=offset+1;if(this.doneCountEventTypes<tempKeys.length){//console.log('short, running again');
this.getEventTypeSessions(offset);}else{if(obj.response.entities.asset!=undefined){obj2.response.entities.asset.sort((a,b)=>a.assetSequenceInfo.numOfEvents>b.assetSequenceInfo.numOfEvents?1:-1);}if(obj.response.entities.session!=undefined)obj2.response.entities.session.sort((a,b)=>a.sessionInfo.numOfEvents>b.sessionInfo.numOfEvents?1:-1);console.log('starting to get session details');this.getEventTypeSessionDetails(0);}}}});}});}});}getEventTypeSessionDetails(offset){var counter=0;var tempKeys=[];var tempArray=[];var tempAdded=0;this.eventTypes.forEach((obj,index)=>{if(obj.response.entities.session!=undefined)tempKeys.push(obj);});this.todoEventTypeSessions=tempKeys.length;for(var a=0;a<tempKeys.length&&tempAdded<=this.allowedEventTypeCount;a++){//console.log('tempAdded: '+tempAdded);
if(this.doneEventTypeSessions.some(event=>event.name===tempKeys[a].name)){}else{//console.log('pushing '+tempKeys[a].name+' to doneEventTypeSessions');
tempArray.push(tempKeys[a]);this.doneEventTypeSessions.push(tempKeys[a]);tempAdded++;}}tempArray.forEach((obj,index)=>{this.eventTypes.forEach((obj2,index2)=>{if(obj.name===obj2.name){obj2.inSession=true;obj2.sessionCount=obj2.response.entities.session.length;obj2.totalCount=obj2.totalCount+obj2.response.entities.session.length;var tempSessions=0;obj2.response.entities.session.forEach((obj3,index3)=>{if(index3<this.allowedEventTypeCount){tempSessions++;axios_default()('https://'+this.host+'/uba/api/sequence/events/eventType?sequenceType=session&sequenceId='+obj3.sessionInfo.sessionId+'&eventType='+obj2.name+'&numberOfResults='+this.allowedEventsPerSession,{method:'GET',withCredentials:'include'}).then(response=>{for(var i=0;i<Object.keys(response.data).length;i++){obj2.todoSessionEventIDs.push({'sessionId':obj3.sessionInfo.sessionId,'eventId':response.data[i]});}tempSessions--;if(tempSessions===0){this.doneCountEventTypeSessions++;counter++;}this.dataValidationProgress=Math.round(this.doneCountEventTypeSessions/this.todoEventTypeSessions*10+60);//console.log('counter: for event type sessions '+counter+' for offset: '+offset);
if(tempSessions===0&&(counter===this.allowedEventTypeCount+1||this.todoEventTypeSessions-this.doneCountEventTypeSessions===0)){offset++;//console.log('counter: '+counter+' === '+this.allowedEventTypeCount+1+'. offset now '+offset);
if(this.doneCountEventTypeSessions<tempKeys.length){this.getEventTypeSessionDetails(offset);}else{console.log('Moving to Asset Event Details here');this.checkEventTypeSessionDetails(0);}}}).catch(error=>{console.log(error);this.errors.push('Error fetching single session for event type: '+obj2.name);this.errorVisible=true;});}});}});});}checkEventTypeSessionDetails(offset){var counter=0;var tempKeys=[];var tempArray=[];var tempAdded=0;this.eventTypes.forEach((obj,index)=>{if(obj.response.entities.session!=undefined&&obj.todoSessionEventIDs.length!==0)tempKeys.push(obj);});this.todoEventTypeSessionsDetails=tempKeys.length;for(var a=0;a<tempKeys.length&&tempAdded<=this.allowedEventTypeSessionCount;a++){// console.log('tempAdded: ',tempAdded);
if(this.doneEventTypeSessionsDetails.some(event=>event.name===tempKeys[a].name)){}else{// console.log('pushing ',tempKeys[a].name,' to doneEventTypeSessionsDetails');
tempArray.push(tempKeys[a]);this.doneEventTypeSessionsDetails.push(tempKeys[a]);tempAdded++;}}tempArray.forEach((obj,index)=>{this.eventTypes.forEach((obj2,index2)=>{if(obj.name===obj2.name){var tempSessions=0;obj2.todoSessionEventIDs.forEach((obj4,index4)=>{if(obj2.doneSessionEventIDs.some(event=>event.sessionId===obj4.sessionId&&event.eventId===obj4.eventId)){}else{obj2.doneSessionEventIDs.push({'sessionId':obj4.sessionId,'eventId':obj4.eventId});tempSessions++;axios_default()('https://'+this.host+'/uba/api/timeline/events/start?username=*&startSequenceType=session&startSequenceId='+obj4.sessionId+'&preferredNumberOfEvents=1&anomalyOnly=false&sequenceTypes=web&sequenceTypes=session&sequenceTypes=endpoint&sequenceTypes=file&startEventId='+obj4.eventId,{method:'GET',withCredentials:'include'}).then(response=>{obj2.sessionEventDetails.push(response.data);obj2.sessionEventDetails.forEach(obj5=>{if(typeof obj5.firstEvent!=='undefined'){if(typeof obj5.aggregatedEvents[0].es[0].fields.rawlog_refs!=='undefined'){obj5.firstEvent.fields.rawEventSearch='{"rawlog_refs":'+JSON.stringify(obj5.aggregatedEvents[0].es[0].fields.rawlog_refs)+'}';}Object.keys(obj5.firstEvent.fields).forEach(obj6=>{if(obj2.sessionEventFields.some(theField=>theField.toLowerCase().replace(/ /g,"")===obj6.toLowerCase().replace(/ /g,""))){}else{obj2.sessionEventFields.push(obj6.toLowerCase().replace(/ /g,""));}});}});tempSessions--;if(tempSessions===0){this.doneCountEventTypeSessionsDetails++;counter++;}this.dataValidationProgress=Math.round(this.doneCountEventTypeSessionsDetails/this.todoEventTypeSessionsDetails*10+80);//console.log('counter: for event type sessions '+counter+' for offset: '+offset);
if(tempSessions===0&&(counter===this.allowedEventTypeSessionCount+1||this.todoEventTypeSessionsDetails-this.doneCountEventTypeSessionsDetails===0)){offset++;if(this.doneCountEventTypeSessionsDetails<tempKeys.length){this.checkEventTypeSessionDetails(offset);}else{this.getEventTypeAssetDetails(0);}}}).catch(error=>{console.log(error);this.errors.push('Error fetching single session event for event type: '+obj2.name);this.errorVisible=true;});}});}});});}getEventTypeAssetDetails(offset){var counter=0;var tempKeys=[];var tempArray=[];var tempAdded=0;this.eventTypes.forEach((obj,index)=>{if(obj.response.entities.asset!=undefined)tempKeys.push(obj);});this.todoEventTypeAssets=tempKeys.length;for(var a=0;a<tempKeys.length&&tempAdded<=this.allowedEventTypeCount;a++){if(this.doneEventTypeAssets.some(event=>event.name===tempKeys[a].name)){}else{tempArray.push(tempKeys[a]);this.doneEventTypeAssets.push(tempKeys[a]);tempAdded++;}}tempArray.forEach((obj,index)=>{this.eventTypes.forEach((obj2,index2)=>{if(obj.name===obj2.name){obj2.inAsset=true;obj2.assetCount=obj2.response.entities.asset.length;obj2.totalCount=obj2.totalCount+obj2.response.entities.asset.length;var tempSessions=0;obj2.response.entities.asset.forEach((obj3,index3)=>{if(index3<this.allowedEventTypeCount){tempSessions++;axios_default()('https://'+this.host+'/uba/api/asset/timeline/events/start?assetId='+obj3.assetSequenceInfo.assetId+'&startAssetSequenceId='+obj3.assetSequenceInfo.assetSequenceId+'&preferredNumberOfEvents=5&anomalyOnly=false&eventCategories=*&sequenceTypes=asset&eventTypes='+obj2.name+'&eventTypeInclude=true',{method:'GET',withCredentials:'include'}).then(response=>{obj2.assetEventDetails.push(response.data);obj2.assetEventDetails.forEach(obj5=>{if(typeof obj5.firstEvent!=='undefined'){obj5.aggregatedEvents[0].es.forEach(obj6=>{if(typeof obj6.fields.rawlog_refs!=='undefined'){obj6.fields.rawEventSearch='{"rawlog_refs":'+JSON.stringify(obj6.fields.rawlog_refs)+'}';}Object.keys(obj6.fields).forEach(obj7=>{if(obj2.assetEventFields.some(theField=>theField.toLowerCase().replace(/ /g,"")===obj7.toLowerCase().replace(/ /g,""))){}else{obj2.assetEventFields.push(obj7.toLowerCase().replace(/ /g,""));}});});}});tempSessions--;if(tempSessions===0){this.doneCountEventTypeAssets++;counter++;}this.dataValidationProgress=Math.round(this.doneCountEventTypeAssets/this.todoEventTypeAssets*10+80);//console.log('counter: for event type sessions '+counter+' for offset: '+offset);
if(tempSessions===0&&(counter===this.allowedEventTypeCount+1||this.todoEventTypeAssets-this.doneCountEventTypeAssets===0)){offset++;//console.log('counter: '+counter+' === '+this.allowedEventTypeCount+1+'. offset now '+offset);
if(this.doneCountEventTypeAssets<tempKeys.length){this.getEventTypeAssetDetails(offset);}else{console.log('Moved on to getRawEvents here');this.getRawEvents(0,0);}}}).catch(error=>{console.log(error);this.errors.push('Error fetching single session event for event type: '+obj2.name);this.errorVisible=true;});}});}});});}// getEventTypeAssetDetails(offset){
//   var counter = 0;
//   var tempKeys = []
//   var tempArray = [];
//   var tempAdded = 0;
//   this.eventTypes.forEach((obj,index) => {
//     if (obj.response.entities.asset != undefined) tempKeys.push(obj);
//   })
//   this.todoEventTypeAssets = tempKeys.length;
//   for (var a=0; a < tempKeys.length && tempAdded <= this.allowedEventTypeCount; a++) {
//     if(this.doneEventTypeAssets.some(event => event.name === tempKeys[a].name)) {
//     } else {
//       tempArray.push(tempKeys[a]);
//       this.doneEventTypeAssets.push(tempKeys[a]);
//       tempAdded++;
//     }      
//   }
//   tempArray.forEach((obj,index) => {
//     this.eventTypes.forEach((obj2, index2) => {
//       if(obj.name === obj2.name) {
//           obj2.inAsset = true;
//           obj2.assetCount = obj2.response.entities.asset.length;
//           obj2.totalCount = obj2.totalCount + obj2.response.entities.asset.length; 
//           var tempSessions = 0                
//           obj2.response.entities.asset.forEach((obj3,index3) => {
//           if(index3 < this.allowedEventTypeCount) {
//             tempSessions++
//             axios('https://'+this.host+'/uba/api/sequence/events/eventType?sequenceType=asset&sequenceId='+obj3.assetSequenceInfo.assetSequenceId+'&eventType='+obj2.name+'&numberOfResults='+this.allowedEventsPerSession, {
//               method: 'GET',
//               withCredentials: 'include',
//             }).then(response => {
//               for (var i = 0; i < Object.keys(response.data).length; i++) {
//                 obj2.todoAssetEventIDs.push({'sessionId': obj3.assetSequenceInfo.assetSequenceId, 'assetId': obj3.assetSequenceInfo.assetId, 'eventId': response.data[i]});
//               }
//               tempSessions--                
//               if(tempSessions === 0){
//                 this.doneCountEventTypeAssets++;
//                 counter++;
//               } 
//               this.dataValidationProgress = Math.round((((this.doneCountEventTypeAssets/this.todoEventTypeAssets) * 10) + 70));
//               //console.log('counter: for event type sessions '+counter+' for offset: '+offset);
//               if(tempSessions === 0 && (counter === this.allowedEventTypeCount+1 || this.todoEventTypeAssets-this.doneCountEventTypeAssets === 0)) {
//                 offset++;
//                 //console.log('counter: '+counter+' === '+this.allowedEventTypeCount+1+'. offset now '+offset);
//                 if(this.doneCountEventTypeAssets < tempKeys.length) {
//                   this.getEventTypeAssetDetails(offset);
//                 } else {
//                   console.log('Moving to Session Event Details here');
//                   this.checkEventTypeSessionDetails(0);
//                 }
//               }
//             }).catch(error => {
//               console.log(error);
//               this.errors.push('Error fetching single session for event type: '+obj2.name);
//               this.errorVisible = true;
//             });
//           }
//         })
//       }
//     })
//   })
// }
// checkEventTypeAssetDetails(offset) {
//   var counter = 0;
//   var tempKeys = []
//   var tempArray = [];
//   var tempAdded = 0;
//   this.eventTypes.forEach((obj,index) => {
//     if (obj.response.entities.asset != undefined && obj.todoAssetEventIDs.length !== 0) tempKeys.push(obj);
//   })
//   this.todoEventTypeAssetsDetails = tempKeys.length;
//   for (var a=0; a < tempKeys.length && tempAdded <= this.allowedEventTypeSessionCount; a++) {
//     //console.log('tempAdded: '+tempAdded);
//     if(this.doneEventTypeAssetsDetails.some(event => event.name === tempKeys[a].name)) {
//     } else {
//       //console.log('pushing '+tempKeys[a].name+' to doneEventTypeSessionsDetails');
//       tempArray.push(tempKeys[a]);
//       this.doneEventTypeAssetsDetails.push(tempKeys[a]);
//       tempAdded++;
//     }      
//   }
//   tempArray.forEach((obj,index) => {
//     this.eventTypes.forEach((obj2, index2) => {
//       if(obj.name === obj2.name) {
//         var tempSessions = 0;       
//         obj2.todoAssetEventIDs.forEach((obj4,index4) => {
//           if(obj2.doneAssetEventIDs.some(event => event.sessionId === obj4.sessionId && event.eventId === obj4.eventId)){
//           } else {
//             obj2.doneAssetEventIDs.push({'sessionId': obj4.sessionId, 'eventId': obj4.eventId});
//             tempSessions++
//             axios('https://'+this.host+'/uba/api/asset/timeline/events/start?assetId='+obj4.assetId+'&startAssetSequenceId='+obj4.sessionId+'&preferredNumberOfEvents=1&anomalyOnly=false&eventCategories=*&sequenceTypes=asset&eventTypes='+obj2.name+'&eventTypeInclude=true&startEventId='+obj4.eventId, {
//               method: 'GET',
//               withCredentials: 'include',
//             }).then(response => {
//               obj2.assetEventDetails.push(response.data);
//                 obj2.assetEventDetails.forEach((obj5) => {
//                   if(typeof obj5.firstEvent !== 'undefined') {
//                     if(typeof obj5.aggregatedEvents[0].es[0].fields.rawlog_refs !== 'undefined') {
//                       obj5.firstEvent.fields.rawEventSearch = '{"rawlog_refs":'+JSON.stringify(obj5.aggregatedEvents[0].es[0].fields.rawlog_refs)+'}';
//                     }
//                     Object.keys(obj5.firstEvent.fields).forEach((obj6) => {
//                       if(obj2.assetEventFields.some(theField => theField.toLowerCase().replace(/ /g,"") === obj6.toLowerCase().replace(/ /g,""))) {
//                       } else{
//                         obj2.assetEventFields.push(obj6.toLowerCase().replace(/ /g,""));
//                         }
//                       })
//                     }                              
//                   })
//                   tempSessions--                
//                   if(tempSessions === 0){
//                     this.doneCountEventTypeAssetsDetails++;
//                     counter++;
//                   } 
//                   this.dataValidationProgress = Math.round((((this.doneCountEventTypeAssetsDetails/this.todoEventTypeAssetsDetails) * 10) + 80));
//                   //console.log('counter: for event type sessions '+counter+' for offset: '+offset);
//                   if(tempSessions === 0 && (counter === this.allowedEventTypeSessionCount+1 || this.todoEventTypeAssetsDetails-this.doneCountEventTypeAssetsDetails === 0)) {
//                     offset++;
//                     //console.log('counter: '+counter+' === '+this.allowedEventTypeSessionCount+1+'. offset now '+offset);
//                     if(this.doneCountEventTypeAssetsDetails < tempKeys.length) {
//                       this.checkEventTypeAssetDetails(offset);
//                     } else {
//                       console.log('Moved on to getRawEvents here');
//                       this.getRawEvents(0,0);
//                     }
//                   }
//             }).catch(error => {
//               console.log(error);
//               this.errors.push('Error fetching single session event for event type: '+obj2.name);
//               this.errorVisible = true;
//             });
//           }                                                                     
//         })                        
//       }
//     })
//   })
// }
getRawEvents(offset,retryAttempt){// console.log('started getRawEvents. offset: ',offset);
this.retryAttemptRawEventsCount=retryAttempt;var counter=0;var tempKeys=[];var tempArray=[];var tempAdded=0;this.eventTypes.forEach(obj=>{obj.sessionEventDetails.forEach(obj2=>{if(typeof obj2.firstEvent.fields.rawEventSearch!=='undefined'&&obj2.firstEvent.fields.rawEventSearch!=null&&obj2.firstEvent.fields.rawEventSearch!=''){if(tempKeys.some(event=>event===obj2.firstEvent.fields.rawEventSearch)){}else{tempKeys.push(obj2.firstEvent.fields.rawEventSearch);}if(typeof obj2.firstEvent.fields.dlEvent!=='undefined'){if(this.doneRawEvents.some(event=>event===obj2.firstEvent.fields.rawEventSearch)){}else{this.validDoneRawEventsCount++;this.doneRawEventsCount++;this.doneRawEvents.push(obj2.firstEvent.fields.rawEventSearch);}}}});obj.assetEventDetails.forEach(obj2=>{if(typeof obj2.aggregatedEvents[0]!=='undefined'){obj2.aggregatedEvents[0].es.forEach(obj6=>{if(typeof obj6.fields.rawEventSearch!=='undefined'&&obj6.fields.rawEventSearch!=null&&obj6.fields.rawEventSearch!=''){if(tempKeys.some(event=>event===obj6.fields.rawEventSearch)){}else{tempKeys.push(obj6.fields.rawEventSearch);}if(typeof obj6.fields.dlEvent!=='undefined'){if(this.doneRawEvents.some(event=>event===obj6.fields.rawEventSearch)){}else{this.validDoneRawEventsCount++;this.doneRawEventsCount++;this.doneRawEvents.push(obj6.fields.rawEventSearch);}}}});}});});this.todoRawEventsCount=tempKeys.length;if(this.validDoneRawEventsCount!=this.todoRawEventsCount){this.visibleDataValidationProgress=true;}for(var a=0;a<tempKeys.length&&tempAdded<=this.allowedRawEventCount;a++){if(this.doneRawEvents.some(event=>event===tempKeys[a])){}else{tempArray.push(tempKeys[a]);this.doneRawEvents.push(tempKeys[a]);tempAdded++;// console.log('tempAdded updated to ', tempAdded);
}}var templength=this.doneRawEvents.length;// console.log('this.doneRawEvents.length = ', templength);
// console.log('this.doneRawEventsCount = ', this.doneRawEventsCount);
if(tempArray.length===0){// console.log('tempArray.length === 0, nothing to query');
if(this.onPreviousSession){this.findRequiredData(this.rulesAndModels);}else{this.bootstrapEventTypes();}}// console.log('setup arrays, tempArray.length = ', tempArray.length);
if(offset===0&&retryAttempt===0){// console.log('First offset and no retry check');
// console.log('this.todoRawEventsCount = ', this.todoRawEventsCount);
// console.log('this.validDoneRawEventsCount = ', this.validDoneRawEventsCount);
// console.log('this.doneRawEventsCount = ', this.doneRawEventsCount);
}//Get raw events from DL all rules if triggered
tempArray.forEach(obj=>{if(obj!=undefined){this.activeRawEvents++;chrome.tabs.sendMessage(this.tabID,{message:"rawEventSearch",rawlog_refs:obj},response=>{if(typeof response[Object.keys(response)[0]]!=='undefined'&&typeof response[Object.keys(response)[0]][0].hits!=='undefined'){this.eventTypes.forEach(obj2=>{obj2.sessionEventDetails.forEach(obj3=>{if(obj3.firstEvent.fields.rawEventSearch===obj){obj3.firstEvent.fields.dlEvent=response[Object.keys(response)[0]][0].hits.hits[0]._source;}});obj2.assetEventDetails.forEach(obj3=>{if(typeof obj2.aggregatedEvents!=='undefined'){obj2.aggregatedEvents[0].es.forEach(obj6=>{if(obj6.fields.rawEventSearch===obj){obj6.fields.dlEvent=response[Object.keys(response)[0]][0].hits.hits[0]._source;}});}});});this.activeEventTypes--;counter++;this.doneRawEventsCount++;this.validDoneRawEventsCount++;this.dataValidationProgress=Math.round(this.doneRawEventsCount/this.todoRawEventsCount*10+90);// console.log('got a response');
// console.log('counter = ', counter);
// console.log('offset = ', counter);
// console.log('this.todoRawEventsCount = ', this.todoRawEventsCount);
var templength=this.doneRawEvents.length;// console.log('this.doneRawEvents.length = ', templength);
// console.log('this.doneRawEventsCount = ', this.doneRawEventsCount);
// console.log('this.validDoneRawEventsCount = ', this.validDoneRawEventsCount);
if(counter===this.allowedRawEventCount+1||this.todoRawEventsCount-this.doneRawEventsCount===0){offset++;if(this.doneRawEventsCount<tempKeys.length){// console.log('short, running again');
this.getRawEvents(offset,this.retryAttemptRawEventsCount);}else{if(this.doneRawEventsCount===this.validDoneRawEventsCount){// All raw events successfully queired, moving on to bootstrapEventTypes
// console.log('All raw events successfully queired, moving on');
if(this.onPreviousSession){this.findRequiredData(this.rulesAndModels);}else{this.bootstrapEventTypes();}}else{if(this.retryAttemptRawEventsCount<=10){// Some raw events not queired successfully and retry attempt is less than 10, go back back fetch missing raw events
// console.log('Some raw events not queired successfully and retry attempt is less than 10, go back back fetch missing raw events');
// console.log('this.retryAttemptRawEventsCount = ', this.retryAttemptRawEventsCount);
// console.log('this.todoRawEventsCount = ', this.todoRawEventsCount);
// console.log('this.validDoneRawEventsCount = ', this.validDoneRawEventsCount);
// console.log('this.doneRawEventsCount = ', this.doneRawEventsCount);
this.retryAttemptRawEventsCount++;this.doneRawEventsCount=0;this.rawEventErrors=0;this.validDoneRawEventsCount=0;this.doneRawEvents=[];this.getRawEvents(0,this.retryAttemptRawEventsCount);}else{// Some raw events still not queired successfuly, but retry attemps is greater than 10 so we need to move on
console.log('Some raw events still not queired successfuly, but retry attemps is greater than 10 so we need to move on');console.log('this.todoRawEventsCount = ',this.todoRawEventsCount);console.log('this.validDoneRawEventsCount = ',this.validDoneRawEventsCount);console.log('this.doneRawEventsCount = ',this.doneRawEventsCount);if(this.onPreviousSession){this.findRequiredData(this.rulesAndModels);}else{this.bootstrapEventTypes();}}}}}}else{this.rawEventErrors++;this.errorVisible=true;this.activeEventTypes--;counter++;this.doneRawEventsCount++;this.dataValidationProgress=Math.round(this.doneRawEventsCount/this.todoRawEventsCount*10+90);this.sleep(10000);// console.log('got a response');
// console.log('counter = ', counter);
// console.log('offset = ', counter);
// console.log('this.todoRawEventsCount = ', this.todoRawEventsCount);
var templength=this.doneRawEvents.length;// console.log('this.doneRawEvents.length = ', templength);
// console.log('this.doneRawEventsCount = ', this.doneRawEventsCount);
// console.log('this.validDoneRawEventsCount = ', this.validDoneRawEventsCount);
if(counter===this.allowedRawEventCount+1||this.todoRawEventsCount-this.doneRawEventsCount===0){offset++;if(this.doneRawEventsCount<tempKeys.length){// console.log('short, running again');
this.getRawEvents(offset,this.retryAttemptRawEventsCount);}else{if(this.doneRawEventsCount===this.validDoneRawEventsCount){// All raw events successfully queired, moving on to bootstrapEventTypes
// console.log('All raw events successfully queired, moving on');
if(this.onPreviousSession){this.findRequiredData(this.rulesAndModels);}else{this.bootstrapEventTypes();}}else{if(this.retryAttemptRawEventsCount<=10){// Some raw events not queired successfully and retry attempt is less than 10, go back back fetch missing raw events
// console.log('Some raw events not queired successfully and retry attempt is less than 10, go back back fetch missing raw events');
// console.log('this.retryAttemptRawEventsCount = ', this.retryAttemptRawEventsCount);
// console.log('this.todoRawEventsCount = ', this.todoRawEventsCount);
// console.log('this.validDoneRawEventsCount = ', this.validDoneRawEventsCount);
// console.log('this.doneRawEventsCount = ', this.doneRawEventsCount);
this.retryAttemptRawEventsCount++;this.doneRawEventsCount=0;this.rawEventErrors=0;this.validDoneRawEventsCount=0;this.doneRawEvents=[];this.getRawEvents(0,this.retryAttemptRawEventsCount);}else{// Some raw events still not queired successfuly, but retry attemps is greater than 3 so we need to move on
// console.log('Some raw events still not queired successfuly, but retry attemps is greater than 3 so we need to move on');
// console.log('this.todoRawEventsCount = ', this.todoRawEventsCount);
// console.log('this.validDoneRawEventsCount = ', this.validDoneRawEventsCount);
// console.log('this.doneRawEventsCount = ', this.doneRawEventsCount);
if(this.onPreviousSession){this.findRequiredData(this.rulesAndModels);}else{this.bootstrapEventTypes();}}}}}}});}});}bootstrapEventTypes(){this.eventTypes.forEach((obj2,index2)=>{obj2.totalCount=0;obj2.rules=[];obj2.models=[];obj2.assetEventIDs=[];obj2.requiredEventFields=[];obj2.presentEventFields=[];obj2.missingEventFields=[];obj2.missingEventFieldTable=[];obj2.fieldsPopulating=0;obj2.fieldsPopulatingPercent=0;obj2.modelsPopulating=0;obj2.modelsPopulatingPercent=0;obj2.rulesCouldTrigger=0;obj2.rulesCouldTriggerPercent=0;obj2.uniqueUsersList=[];obj2.uniqueHostsList=[];obj2.uniqueIPsList=[];obj2.uniqueUsers=0;obj2.uniqueHosts=0;obj2.uniqueIPs=0;if(obj2.response.entities.session!=undefined){obj2.response.entities.session.forEach((obj3,index3)=>{if(!obj3.sessionInfo.username.endsWith('$')){if(obj2.uniqueUsersList.some(user=>user.name===obj3.sessionInfo.username.toLowerCase())){}else{obj2.uniqueUsers=obj2.uniqueUsers+1;obj2.uniqueUsersList.push({'name':obj3.sessionInfo.username.toLowerCase()});}if(this.summary.uniqueUsers.some(user=>user.name===obj3.sessionInfo.username.toLowerCase())){}else{this.summary.uniqueUsers.push({'name':obj3.sessionInfo.username.toLowerCase()});this.summary.uniqueUserCount=this.summary.uniqueUserCount+1;}}});}if(obj2.response.entities.asset!=undefined){obj2.response.entities.asset.forEach((obj3,index3)=>{if(!((obj3.assetSequenceInfo.assetId.match(/\d\./g)||[]).length===3)){if(!((obj3.assetSequenceInfo.assetId.match(/\:/g)||[]).length>=1)){if(obj2.uniqueHostsList.some(user=>user.name===obj3.assetSequenceInfo.assetId.toLowerCase())){}else{obj2.uniqueHosts=obj2.uniqueHosts+1;obj2.uniqueHostsList.push({'name':obj3.assetSequenceInfo.assetId.toLowerCase()});}if(this.summary.uniqueHosts.some(user=>user.name===obj3.assetSequenceInfo.assetId.toLowerCase())){}else{this.summary.uniqueHosts.push({'name':obj3.assetSequenceInfo.assetId.toLowerCase()});this.summary.uniqueHostCount=this.summary.uniqueHostCount+1;}}}});}if(obj2.response.entities.lockout!=undefined){obj2.response.entities.lockout.forEach((obj3,index3)=>{if(!obj3.lockoutInfo.username.endsWith('$')){if(obj2.uniqueUsersList.some(user=>user.name===obj3.lockoutInfo.username.toLowerCase())){}else{obj2.uniqueUsers=obj2.uniqueUsers+1;obj2.uniqueUsersList.push({'name':obj3.lockoutInfo.username.toLowerCase()});}if(this.summary.uniqueUsers.some(user=>user.name===obj3.lockoutInfo.username.toLowerCase())){}else{this.summary.uniqueUsers.push({'name':obj3.lockoutInfo.username.toLowerCase()});this.summary.uniqueUserCount=this.summary.uniqueUserCount+1;}}});}obj2.sequenceTypes=[];Object.keys(obj2.response.entities).forEach((obj3,index3)=>{if(obj3!='session'&&obj3!='asset'&&obj3!='lockout')obj2.sequenceTypes.push(obj3);});obj2.sequenceTypes.forEach((obj3,index3)=>{obj2.response.entities[obj3].forEach((obj4,index4)=>{if(!obj4.dataFeedInfo.username.endsWith('$')){if(obj2.uniqueUsersList.some(user=>user.name===obj4.dataFeedInfo.username.toLowerCase())){}else{obj2.uniqueUsers=obj2.uniqueUsers+1;obj2.uniqueUsersList.push({'name':obj4.dataFeedInfo.username.toLowerCase()});}if(this.summary.uniqueUsers.some(user=>user.name===obj4.dataFeedInfo.username.toLowerCase())){}else{this.summary.uniqueUsers.push({'name':obj4.dataFeedInfo.username.toLowerCase()});this.summary.uniqueUserCount=this.summary.uniqueUserCount+1;}}});});if(obj2.response.entities.endpoint!=undefined){obj2.inEndpoint=true;obj2.endpointCount=obj2.response.entities.endpoint.length;obj2.totalCount=obj2.totalCount+obj2.response.entities.endpoint.length;}if(obj2.response.entities.file!=undefined){obj2.inFile=true;obj2.fileCount=obj2.response.entities.file.length;obj2.totalCount=obj2.totalCount+obj2.response.entities.file.length;}if(obj2.response.entities.web!=undefined){obj2.inWeb=true;obj2.webCount=obj2.response.entities.web.length;obj2.totalCount=obj2.totalCount+obj2.response.entities.web.length;}if(obj2.response.entities.database!=undefined){obj2.inDatabase=true;obj2.databaseCount=obj2.response.entities.database.length;obj2.totalCount=obj2.totalCount+obj2.response.entities.database.length;}if(obj2.response.entities.lockout!=undefined){obj2.inLockout=true;obj2.lockoutCount=obj2.response.entities.lockout.length;obj2.totalCount=obj2.totalCount+obj2.response.entities.lockout.length;}if(Object.keys(obj2.response.entities).length!=0){obj2.populating=true;}else{obj2.populating=false;}});this.checkFeature();}checkFeature(){this.rulesAndModels.forEach((obj,index)=>{if(obj.modelDef!=undefined){obj.featurePresent='false';}else{obj.featurePresent='N/A';}this.eventTypes.forEach((obj2,index2)=>{obj2.uniqueUserPercent=Math.round(obj2.uniqueUsers/this.summary.uniqueUserCount*100);obj2.uniqueHostPercent=Math.round(obj2.uniqueHosts/this.summary.uniqueHostCount*100);if(obj.ruleDef.requiredEvents.some(type=>type===obj2.name)){if(obj.modelDef!=undefined){if(obj.modelDef.modelType==='NUMERICAL_TIME_OF_WEEK')obj.featurePresent='true';if(obj.populating==='true')obj.featurePresent='true';if(obj2.inSession){obj2.sessionEventFields.forEach((obj3,index)=>{obj.modelDef.requiredEventFields.forEach((obj4,index)=>{if(obj3===obj4){if(obj.modelDef.presentEventFields.some(field=>field===obj4)){}else{obj.modelDef.presentEventFields.push(obj3);}}if(obj.modelDef.requiredEventFields.length===obj.modelDef.presentEventFields.length)obj.featurePresent='true';});});}if(obj2.inAsset){obj2.assetEventFields.forEach((obj3,index)=>{obj.modelDef.requiredEventFields.forEach((obj4,index)=>{if(obj3===obj4){if(obj.modelDef.presentEventFields.some(field=>field===obj4)){}else{obj.modelDef.presentEventFields.push(obj3);}}if(obj.modelDef.requiredEventFields.length===obj.modelDef.presentEventFields.length)obj.featurePresent='true';});});}}}});});this.checkMissingEvents();}checkMissingEvents(){this.rulesAndModels.forEach((obj,index)=>{this.eventTypes.forEach((obj2,index2)=>{if(obj.ruleDef.requiredEvents.some(type=>type===obj2.name)){if(obj.modelDef!=undefined){obj.modelDef.requiredEventFields.forEach((obj3,index)=>{if(obj.modelDef.presentEventFields.some(field=>field===obj3)){}else{if(obj.modelDef.missingEventFields.some(field=>field===obj3)){}else{obj.modelDef.missingEventFields.push(obj3);}}});}}});});this.addEventDetails();}addEventDetails(){var doneCount=0;this.rulesAndModels.forEach((obj,index)=>{obj.eventInRuleType='false';obj.presentEventTypes=[];this.eventTypes.forEach((obj2,index2)=>{if(obj.ruleDef.requiredEvents.some(types=>types===obj2.name)){obj2.rules.push(obj.ruleDef);if(obj.modelDef!=undefined){obj2.models.push(obj.modelDef);if(obj.modelDef.populating)obj.ruleDef.modelPopulating=true;}if(obj2.sessionCount!=undefined){obj.inSessions='true';if(obj.ruleDef.ruleType==='session'){obj.presentEventTypes.push(obj2.name);obj.eventInRuleType='true';}}else{obj.inSessions='false';}if(obj2.assetCount!=undefined){obj.inAssets='true';if(obj.ruleDef.ruleType==='asset'){obj.presentEventTypes.push(obj2.name);obj.eventInRuleType='true';}}else{obj.inAssets='false';}if(obj2.endpointCount!=undefined){obj.inEndpoints='true';if(obj.ruleDef.ruleType==='endpoint'){obj.presentEventTypes.push(obj2.name);obj.eventInRuleType='true';}}else{obj.inEndpoints='false';}if(obj2.fileCount!=undefined){obj.inFiles='true';if(obj.ruleDef.ruleType==='file'){obj.presentEventTypes.push(obj2.name);obj.eventInRuleType='true';}}else{obj.inFiles='false';}if(obj2.webCount!=undefined){obj.inWebs='true';if(obj.ruleDef.ruleType==='web'){obj.presentEventTypes.push(obj2.name);obj.eventInRuleType='true';}}else{obj.inWebs='false';}if(obj2.databaseCount!=undefined){obj.inDatabase='true';if(obj.ruleDef.ruleType==='database'){obj.presentEventTypes.push(obj2.name);obj.eventInRuleType='true';}}else{obj.inDatabase='false';}if(obj2.lockoutCount!=undefined){obj.inLockouts='true';if(obj.ruleDef.ruleType==='account-lockout'){obj.presentEventTypes.push(obj2.name);obj.eventInRuleType='true';}}else{obj.inLockouts='false';}obj2.ruleCount=obj2.rules.length;obj2.modelCount=obj2.models.length;//console.log('still in loop');
}});doneCount=doneCount+1;if(doneCount===this.rulesAndModels.length){this.rulesAndModelsDone=this.rulesAndModels;this.rulesAndModels=[];this.columns6=[{field:'ruleCat',header:'Rule Category'},{field:'ruleId',header:'Rule ID'},{field:'ruleName',header:'Rule Name'},{field:'modelName',header:'Model'},{field:'eventInRuleType',header:'Events Present'},{field:'populating',header:'Model Populating'},{field:'hasTriggered',header:'Has Triggered'}];}});this.eventTypes.forEach((obj2,index2)=>{obj2.models.forEach((obj3,index2)=>{if(obj3.populating){obj2.modelsPopulating=obj2.modelsPopulating+1;obj2.modelsPopulatingPercent=Math.round(obj2.modelsPopulating/obj2.modelCount*100);obj2.missingEventFieldTable.forEach((obj5,index5)=>{obj5.percent=Math.round(obj5.count/(obj2.modelCount-obj2.modelsPopulating)*100);});}else{obj3.missingEventFields.forEach((obj4,index2)=>{if(obj2.missingEventFieldTable.length==0){if(obj3.modelType!='NUMERICAL_TIME_OF_WEEK')obj2.missingEventFieldTable.push({'name':obj4,'count':1,'percent':Math.round(1/(obj2.modelCount-obj2.modelsPopulating)*100)});}else{if(obj2.missingEventFieldTable.some(field=>field.name===obj4)){obj2.missingEventFieldTable.forEach((obj5,index5)=>{if(obj5.name===obj4&&obj3.modelType!='NUMERICAL_TIME_OF_WEEK'){obj5.count=obj5.count+1;obj5.percent=Math.round(obj5.count/(obj2.modelCount-obj2.modelsPopulating)*100);}});}else{if(obj3.modelType!='NUMERICAL_TIME_OF_WEEK')obj2.missingEventFieldTable.push({'name':obj4,'count':1,'percent':Math.round(1/(obj2.modelCount-obj2.modelsPopulating)*100)});}}if(obj2.missingEventFields.some(field=>field===obj4)){}else{if(obj3.modelType!='NUMERICAL_TIME_OF_WEEK')obj2.missingEventFields.push(obj4);}});}obj3.requiredEventFields.forEach((obj4,index2)=>{if(obj2.requiredEventFields.some(field=>field===obj4)){}else{obj2.requiredEventFields.push(obj4);}});if(obj2.inSession){obj2.sessionEventFields.forEach((obj4,index4)=>{obj3.requiredEventFields.forEach((obj5,index5)=>{if(obj4===obj5){if(obj2.presentEventFields.some(field=>field===obj4)){}else{obj2.presentEventFields.push(obj4);}}});});}if(obj2.inAsset){obj2.assetEventFields.forEach((obj4,index)=>{obj3.requiredEventFields.forEach((obj5,index)=>{if(obj4===obj5){if(obj2.presentEventFields.some(field=>field===obj4)){}else{obj2.presentEventFields.push(obj4);}}});});}obj2.fieldCount=obj2.requiredEventFields.length;obj2.fieldsPopulating=obj2.presentEventFields.length;obj2.fieldsPopulatingPercent=Math.round(obj2.presentEventFields.length/obj2.requiredEventFields.length*100);});obj2.rules.forEach((obj3,index2)=>{if(obj3.modelPopulating){obj2.rulesCouldTrigger=obj2.rulesCouldTrigger+1;obj2.rulesCouldTriggerPercent=Math.round(obj2.rulesCouldTrigger/obj2.ruleCount*100);}});});this.determineSources(this.eventTypes);}determineSources(eventTypes){this.sources=[];this.sourcesDone=[];eventTypes.forEach(obj=>{obj.sessionEventDetails.forEach(obj2=>{if(this.sources.some(source=>source.source===obj2.firstEvent.fields.source&&source.name===obj2.firstEvent.fields.event_type)){}else{this.sources.push({'source':obj2.firstEvent.fields.source,'name':obj2.firstEvent.fields.event_type,'inSession':false,'inAsset':false,'configIssues':0,'sessionConfigIssueEvents':[],'assetConfigIssueEvents':[],'missingAssetEvents':false,'missingSessionEvents':false,'sessionEventsWithSrcOrDestHost':0,'sessionEventsWithEntityId':0,'assetEventsWithUser':0,'assetEventsWithSessionId':0,'parsingIssues':0,'aaSessionEventParsingIssues':{'src_ip':[],'src_host':[],'dest_ip':[],'dest_host':[],'host':[],'user':[]},'aaAssetEventParsingIssues':{'src_ip':[],'src_host':[],'dest_ip':[],'dest_host':[],'host':[],'user':[]},'aaSessionEventFieldCounts':{'src_ip':0,'src_host':0,'dest_ip':0,'dest_host':0,'host':0,'user':0},'dlSessionEventFieldCounts':{'src_ip':0,'src_host':0,'dest_ip':0,'dest_host':0,'host':0,'user':0},'aaAssetEventFieldCounts':{'src_ip':0,'src_host':0,'dest_ip':0,'dest_host':0,'host':0,'user':0},'dlAssetEventFieldCounts':{'src_ip':0,'src_host':0,'dest_ip':0,'dest_host':0,'host':0,'user':0},'sessionRawEventCount':0,'assetRawEventCount':0,'sessionEvents':[],'assetEvents':[],'models':obj.models,'rules':obj.rules});}});obj.assetEventDetails.forEach(obj2=>{obj2.aggregatedEvents[0].es.forEach(obj6=>{if(this.sources.some(source=>source.source===obj6.fields.source&&source.name===obj6.fields.event_type)){}else{this.sources.push({'source':obj6.fields.source,'name':obj6.fields.event_type,'inSession':false,'inAsset':false,'configIssues':0,'sessionConfigIssueEvents':[],'assetConfigIssueEvents':[],'missingAssetEvents':false,'missingSessionEvents':false,'sessionEventsWithSrcOrDestHost':0,'sessionEventsWithEntityId':0,'assetEventsWithUser':0,'assetEventsWithSessionId':0,'parsingIssues':0,'aaSessionEventParsingIssues':{'src_ip':[],'src_host':[],'dest_ip':[],'dest_host':[],'host':[],'user':[]},'aaAssetEventParsingIssues':{'src_ip':[],'src_host':[],'dest_ip':[],'dest_host':[],'host':[],'user':[]},'aaSessionEventFieldCounts':{'src_ip':0,'src_host':0,'dest_ip':0,'dest_host':0,'host':0,'user':0},'dlSessionEventFieldCounts':{'src_ip':0,'src_host':0,'dest_ip':0,'dest_host':0,'host':0,'user':0},'aaAssetEventFieldCounts':{'src_ip':0,'src_host':0,'dest_ip':0,'dest_host':0,'host':0,'user':0},'dlAssetEventFieldCounts':{'src_ip':0,'src_host':0,'dest_ip':0,'dest_host':0,'host':0,'user':0},'sessionRawEventCount':0,'assetRawEventCount':0,'sessionEvents':[],'assetEvents':[],'models':obj.models,'rules':obj.rules});}});});obj.sessionEventDetails.forEach(obj2=>{this.sources.forEach(obj3=>{if(obj3.source===obj2.firstEvent.fields.source&&obj3.name===obj2.firstEvent.fields.event_type){obj3.sessionEvents.push(obj2.firstEvent.fields);obj3.inSession=true;let tempSrcHost='';let tempDestHost='';if(typeof obj2.firstEvent.fields.src_host!=='undefined'&&obj2.firstEvent.fields.src_host!=='localhost')tempSrcHost=obj2.firstEvent.fields.src_host;if(typeof obj2.firstEvent.fields.dest_host!=='undefined'&&obj2.firstEvent.fields.dest_host!=='localhost')tempDestHost=obj2.firstEvent.fields.dest_host;//config issue check
if(typeof obj2.firstEvent.fields.src_host!=='undefined'&&obj2.firstEvent.fields.src_host!=='localhost'||typeof obj2.firstEvent.fields.dest_host!=='undefined'&&obj2.firstEvent.fields.dest_host!=='localhost')obj3.sessionEventsWithSrcOrDestHost++;if(typeof obj2.firstEvent.fields.entity_asset_id!=='undefined')obj3.sessionEventsWithEntityId++;if((typeof obj2.firstEvent.fields.src_host!=='undefined'&&obj2.firstEvent.fields.src_host!=='localhost'||typeof obj2.firstEvent.fields.dest_host!=='undefined'&&obj2.firstEvent.fields.dest_host!=='localhost')&&typeof obj2.firstEvent.fields.entity_asset_id==='undefined')obj3.sessionConfigIssueEvents.push({src_host:tempSrcHost,dest_host:tempDestHost,fullEvent:obj2.firstEvent.fields});if(obj3.sessionEventsWithSrcOrDestHost>0&&obj3.sessionEventsWithEntityId===0){obj3.missingAssetEvents=true;//obj3.configIssues++;
obj3.configIssues=obj3.sessionConfigIssueEvents.length+obj3.assetConfigIssueEvents.length;}//AA parsed field check
if(typeof obj2.firstEvent.fields.src_ip!=='undefined'){if(!((obj2.firstEvent.fields.src_ip.match(/\:/g)||[]).length>=1)){obj3.aaSessionEventFieldCounts.src_ip++;}}if(typeof obj2.firstEvent.fields.src_host!=='undefined')obj3.aaSessionEventFieldCounts.src_host++;if(typeof obj2.firstEvent.fields.dest_ip!=='undefined'){if(!((obj2.firstEvent.fields.dest_ip.match(/\:/g)||[]).length>=1)){obj3.aaSessionEventFieldCounts.dest_ip++;}}if(typeof obj2.firstEvent.fields.dest_host!=='undefined')obj3.aaSessionEventFieldCounts.dest_host++;if(typeof obj2.firstEvent.fields.host!=='undefined')obj3.aaSessionEventFieldCounts.host++;if(typeof obj2.firstEvent.fields.user!=='undefined'){if(obj2.firstEvent.fields.user!=='system'&&!obj2.firstEvent.fields.user.endsWith('$')&&!obj2.firstEvent.fields.user.includes('*')&&!obj2.firstEvent.fields.user.includes('anonymous')&&obj2.firstEvent.fields.event_type!=='failed-logon'&&obj2.firstEvent.fields.event_type!=='computer-logon')obj3.aaSessionEventFieldCounts.user++;}//DL parsed field check
if(typeof obj2.firstEvent.fields.dlEvent!=='undefined'){obj3.sessionRawEventCount++;if(typeof obj2.firstEvent.fields.dlEvent.src_ip!=='undefined'){if(!((obj2.firstEvent.fields.dlEvent.src_ip.match(/\:/g)||[]).length>=1)){if(typeof obj2.firstEvent.fields.src_ip==='undefined'){obj3.parsingIssues++;obj3.aaSessionEventParsingIssues.src_ip.push({parsedInDL:obj2.firstEvent.fields.dlEvent.src_ip,parsedInAA:'',fullEvent:obj2.firstEvent.fields});}obj3.dlSessionEventFieldCounts.src_ip++;}}if(typeof obj2.firstEvent.fields.dlEvent.dest_ip!=='undefined')obj3.dlSessionEventFieldCounts.dest_ip++;if(typeof obj2.firstEvent.fields.dlEvent.dest_ip!=='undefined'){if(!((obj2.firstEvent.fields.dlEvent.dest_ip.match(/\:/g)||[]).length>=1)){if(typeof obj2.firstEvent.fields.dest_ip==='undefined'){obj3.parsingIssues++;obj3.aaSessionEventParsingIssues.dest_ip.push({parsedInDL:obj2.firstEvent.fields.dlEvent.dest_ip,parsedInAA:'',fullEvent:obj2.firstEvent.fields});}obj3.dlSessionEventFieldCounts.dest_ip++;}}if(typeof obj2.firstEvent.fields.dlEvent.src_host!=='undefined'){if(typeof obj2.firstEvent.fields.src_host==='undefined'){obj3.parsingIssues++;obj3.aaSessionEventParsingIssues.src_host.push({parsedInDL:obj2.firstEvent.fields.dlEvent.src_host,parsedInAA:'',fullEvent:obj2.firstEvent.fields});}obj3.dlSessionEventFieldCounts.src_host++;}if(typeof obj2.firstEvent.fields.dlEvent.dest_host!=='undefined'){if(typeof obj2.firstEvent.fields.dest_host==='undefined'){obj3.parsingIssues++;obj3.aaSessionEventParsingIssues.dest_host.push({parsedInDL:obj2.firstEvent.fields.dlEvent.dest_host,parsedInAA:'',fullEvent:obj2.firstEvent.fields});}obj3.dlSessionEventFieldCounts.dest_host++;}if(typeof obj2.firstEvent.fields.dlEvent.host!=='undefined'){if(typeof obj2.firstEvent.fields.host==='undefined'){obj3.parsingIssues++;obj3.aaSessionEventParsingIssues.host.push({parsedInDL:obj2.firstEvent.fields.dlEvent.host,parsedInAA:'',fullEvent:obj2.firstEvent.fields});}obj3.dlSessionEventFieldCounts.host++;}if(typeof obj2.firstEvent.fields.dlEvent.user!=='undefined'){if(obj2.firstEvent.fields.user!=='system'&&!obj2.firstEvent.fields.user.endsWith('$')&&!obj2.firstEvent.fields.user.includes('*')&&!obj2.firstEvent.fields.user.includes('anonymous')&&obj2.firstEvent.fields.event_type!=='failed-logon'&&obj2.firstEvent.fields.event_type!=='computer-logon'){if(typeof obj2.firstEvent.fields.user==='undefined'){obj3.parsingIssues++;obj3.aaSessionEventParsingIssues.user.push({parsedInDL:obj2.firstEvent.fields.dlEvent.user,parsedInAA:'',fullEvent:obj2.firstEvent.fields});}obj3.dlSessionEventFieldCounts.user++;}}}//Only check DL parsed fields if all raw events were successfully fetched from DL
if(obj3.sessionRawEventCount>0&&obj3.sessionRawEventCount!==obj3.sessionEvents.length){obj3.parsingIssues=0;}}});});obj.assetEventDetails.forEach(obj2=>{obj2.aggregatedEvents[0].es.forEach(obj6=>{this.sources.forEach(obj3=>{if(obj3.source===obj6.fields.source&&obj3.name===obj6.fields.event_type){obj3.assetEvents.push(obj6.fields);obj3.inAsset=true;if(typeof obj6.fields.user!=='undefined'){if(obj6.fields.user!=='system'&&!obj6.fields.user.endsWith('$')&&!obj6.fields.user.includes('*')&&!obj6.fields.user.includes('anonymous')&&obj6.fields.event_type!=='failed-logon'&&obj6.fields.event_type!=='computer-logon'){obj3.assetEventsWithUser++;if(typeof obj6.fields.session_id==='undefined'){var isInFeed=false;for(let i=0;i<Object.keys(obj6.fields).length;i++){if(Object.keys(obj6.fields)[i].includes('feed_'))isInFeed=true;}if(!isInFeed)obj3.assetConfigIssueEvents.push({user:obj6.fields.user,fullEvent:obj6.fields});}}}if(typeof obj6.fields.session_id!=='undefined')obj3.assetEventsWithSessionId++;if(obj3.assetEventsWithUser>0&&obj3.assetEventsWithSessionId===0){obj3.missingSessionEvents=true;// obj3.configIssues++;
obj3.configIssues=obj3.sessionConfigIssueEvents.length+obj3.assetConfigIssueEvents.length;}//AA parsed field check
if(typeof obj6.fields.src_ip!=='undefined'){if(!((obj6.fields.src_ip.match(/\:/g)||[]).length>=1)){obj3.aaAssetEventFieldCounts.src_ip++;}}if(typeof obj6.fields.src_host!=='undefined')obj3.aaAssetEventFieldCounts.src_host++;if(typeof obj6.fields.dest_ip!=='undefined'){if(!((obj6.fields.dest_ip.match(/\:/g)||[]).length>=1)){obj3.aaAssetEventFieldCounts.dest_ip++;}}if(typeof obj6.fields.dest_host!=='undefined')obj3.aaAssetEventFieldCounts.dest_host++;if(typeof obj6.fields.host!=='undefined')obj3.aaAssetEventFieldCounts.host++;if(typeof obj6.fields.user!=='undefined'){if(obj6.fields.user!=='system'&&!obj6.fields.user.endsWith('$')&&!obj6.fields.user.includes('*')&&!obj6.fields.user.includes('anonymous')&&obj6.fields.event_type!=='failed-logon'&&obj6.fields.event_type!=='computer-logon')obj3.aaAssetEventFieldCounts.user++;}//DL parsed field check
if(typeof obj6.fields.dlEvent!=='undefined'){obj3.assetRawEventCount++;if(typeof obj6.fields.dlEvent.src_ip!=='undefined'){if(!((obj6.fields.dlEvent.src_ip.match(/\:/g)||[]).length>=1)){if(typeof obj6.fields.src_ip==='undefined'){obj3.parsingIssues++;obj3.aaAssetEventParsingIssues.src_ip.push({parsedInDL:obj6.fields.dlEvent.src_ip,parsedInAA:'',fullEvent:obj6.fields});}obj3.dlAssetEventFieldCounts.src_ip++;}}if(typeof obj6.fields.dlEvent.dest_ip!=='undefined')obj3.dlAssetEventFieldCounts.dest_ip++;if(typeof obj6.fields.dlEvent.dest_ip!=='undefined'){if(!((obj6.fields.dlEvent.dest_ip.match(/\:/g)||[]).length>=1)){if(typeof obj6.fields.dest_ip==='undefined'){obj3.parsingIssues++;obj3.aaAssetEventParsingIssues.dest_ip.push({parsedInDL:obj6.fields.dlEvent.dest_ip,parsedInAA:'',fullEvent:obj6.fields});}obj3.dlAssetEventFieldCounts.dest_ip++;}}if(typeof obj6.fields.dlEvent.src_host!=='undefined'){if(typeof obj6.fields.src_host==='undefined'){obj3.parsingIssues++;obj3.aaAssetEventParsingIssues.src_host.push({parsedInDL:obj6.fields.dlEvent.src_host,parsedInAA:'',fullEvent:obj6.fields});}obj3.dlAssetEventFieldCounts.src_host++;}if(typeof obj6.fields.dlEvent.dest_host!=='undefined'){if(typeof obj6.fields.dest_host==='undefined'){obj3.parsingIssues++;obj3.aaAssetEventParsingIssues.dest_host.push({parsedInDL:obj6.fields.dlEvent.dest_host,parsedInAA:'',fullEvent:obj6.fields});}obj3.dlAssetEventFieldCounts.dest_host++;}if(typeof obj6.fields.dlEvent.host!=='undefined'){if(typeof obj6.fields.host==='undefined'){obj3.parsingIssues++;obj3.aaAssetEventParsingIssues.host.push({parsedInDL:obj6.fields.dlEvent.host,parsedInAA:'',fullEvent:obj6.fields});}obj3.dlAssetEventFieldCounts.host++;}if(typeof obj6.fields.dlEvent.user!=='undefined'){if(obj6.fields.user!=='system'&&!obj6.fields.user.endsWith('$')&&!obj6.fields.user.includes('*')&&!obj6.fields.user.includes('anonymous')&&obj6.fields.event_type!=='failed-logon'&&obj6.fields.event_type!=='computer-logon'){if(typeof obj6.fields.user==='undefined'){obj3.parsingIssues++;obj3.aaAssetEventParsingIssues.user.push({parsedInDL:obj6.fields.dlEvent.user,parsedInAA:'',fullEvent:obj6.fields});}obj3.dlAssetEventFieldCounts.user++;}}}//Only check DL parsed fields if all raw events were successfully fetched from DL
if(obj3.assetRawEventCount>0&&obj3.assetRawEventCount!==obj3.assetEvents.length){obj3.parsingIssues=0;}}});});});});console.log('data validation done');this.sourcesDone=this.sources;this.sources={};this.eventTypesDone=this.eventTypes;this.eventTypes=[];this.loading=false;this.visibleDataValidationProgress=false;this.storeValidationSession();}exportExcel(table){Promise.all(/* import() */[__webpack_require__.e(3), __webpack_require__.e(4)]).then(__webpack_require__.t.bind(null, 151, 7)).then(xlsx=>{const worksheet=xlsx.utils.json_to_sheet(table);const workbook={Sheets:{'data':worksheet},SheetNames:['data']};const excelBuffer=xlsx.write(workbook,{bookType:'xlsx',type:'array'});this.saveAsExcelFile(excelBuffer,"TableExport");});}saveAsExcelFile(buffer,fileName){__webpack_require__.e(/* import() */ 5).then(__webpack_require__.t.bind(null, 152, 7)).then(FileSaver=>{let EXCEL_TYPE='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';let EXCEL_EXTENSION='.xlsx';const data=new Blob([buffer],{type:EXCEL_TYPE});FileSaver.saveAs(data,fileName+'_export_'+new Date().getTime()+EXCEL_EXTENSION);});}onEventTypesSelect(required,present){this.selectedRequiredEventTypes=required;this.selectedPresentEventTypes=present;this.visibleMissingEventTypes=true;}onEventFieldsSelect(sessionEventFields,assetEventFields,missingTable){//this.selectedRequiredEventFields = required;
//this.selectedPresentEventFields = present;
//this.selectedMissingEventFields = missing;
sessionEventFields=sessionEventFields.sort();assetEventFields=assetEventFields.sort();this.selectedSessionEventFields=sessionEventFields;this.selectedAssetEventFields=assetEventFields;this.selectedMissingEventFieldTable=missingTable;this.visibleMissingEventFields=true;}onRuleSelect(rule){this.selectedRule=rule;this.visibleRule=true;}onModelSelect(model){this.selectedModel=model;this.visibleModel=true;}onUsersSelect(users){users=users.sort();this.selectedUserList=users;this.visibleUserList=true;}onHostsSelect(hosts){hosts=hosts.sort();this.selectedHostList=hosts;this.visibleHostList=true;}onServerSelect(){this.visibleServer=true;}// onParsingIssueSelect(sessionUser,sessionSrcIp,sessionSrcHost,sessionDestIp,sessionDestHost,sessionHost,assetUser,assetSrcIp,assetSrcHost,assetDestIp,assetDestHost,assetHost){
onParsingIssueSelect(sessionEvents,assetEvents){// this.selectedSessionUser = sessionUser;
// this.selectedSessionSrcIp = sessionSrcIp;
// this.selectedSessionSrcHost = sessionSrcHost;
// this.selectedSessionDestIp = sessionDestIp;
// this.selectedSessionDestHost = sessionDestHost;
// this.selectedSessionHost = sessionHost;
// this.selectedAssetUser = assetUser;
// this.selectedAssetSrcIp = assetSrcIp;
// this.selectedAssetSrcHost = assetSrcHost;
// this.selectedAssetDestIp = assetDestIp;
// this.selectedAssetDestHost = assetDestHost;
// this.selectedAssetHost = assetHost;
this.sessionParsingIssues=sessionEvents;this.assetParsingIssues=assetEvents;this.visibleParsingIssues=true;}}/* harmony default export */ var src_Home = (Home_Home);
// CONCATENATED MODULE: ./src/reportWebVitals.js
const reportWebVitals=onPerfEntry=>{if(onPerfEntry&&onPerfEntry instanceof Function){__webpack_require__.e(/* import() */ 6).then(__webpack_require__.bind(null, 153)).then(({getCLS,getFID,getFCP,getLCP,getTTFB})=>{getCLS(onPerfEntry);getFID(onPerfEntry);getFCP(onPerfEntry);getLCP(onPerfEntry);getTTFB(onPerfEntry);});}};/* harmony default export */ var src_reportWebVitals = (reportWebVitals);
// CONCATENATED MODULE: ./src/index.js
var src_jsxFileName="C:\\Users\\johnj\\Documents\\exabeam-enhancement-suite\\src\\index.js";Object(mobx_esm["b" /* configure */])({enforceActions:"never"});const versionNumber=0.19;const tablePercentFormat=(rowData,props)=>{let percentField='';percentField=percentField.concat(props.field,'Percent');return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(react_number_format_es["a" /* default */],{value:rowData[props.field],displayType:'text',thousandSeparator:true},void 0,false,{fileName:src_jsxFileName,lineNumber:45,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{style:{color:'green'},children:["(",rowData[percentField],"%) "]},void 0,true,{fileName:src_jsxFileName,lineNumber:47,columnNumber:5},undefined)]},void 0,true);};const eventValueFormat=(rowData,props)=>{let formattedValue=rowData[props.field];if(typeof formattedValue==='object'&&formattedValue!==null)formattedValue=JSON.stringify(rowData[props.field]);return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[formattedValue," "]},void 0,true,{fileName:src_jsxFileName,lineNumber:56,columnNumber:7},undefined)},void 0,false);};const prettyJson=(data,depth)=>{let theTruth=false;let theDepth=2;if(typeof depth!=='undefined')theDepth=depth;return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(main_default.a,{src:data,name:false,collapsed:theDepth,sortKeys:true,iconStyle:"triangle",displayObjectSize:false,displayDataTypes:theTruth,quotesOnKeys:theTruth,displayArrayKey:theTruth},void 0,false,{fileName:src_jsxFileName,lineNumber:65,columnNumber:10},undefined);};const parsingIssueBadge=(header,value)=>{return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:value>0?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:[header," "]},void 0,true,{fileName:src_jsxFileName,lineNumber:73,columnNumber:7},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(badge["Badge"],{value:value,severity:"danger",className:"p-mr-2"},void 0,false,{fileName:src_jsxFileName,lineNumber:74,columnNumber:7},undefined)]},void 0,true):false},void 0,false);};axios_default()('https://api.github.com/repos/jdifeder/exabeam-enhancement-suite/releases',{method:'GET'}).then(response=>{console.log(response.data);var versionNumbers=[];for(var i=0;i<response.data.length;i++){versionNumbers.push(parseFloat(response.data[i].tag_name.substring(1)));}console.log('versionNumbers as numbers = ',versionNumbers);var highestVersion=Math.max(versionNumbers);console.log('highestVersion = ',highestVersion);if(highestVersion>versionNumber){for(var i=0;i<response.data.length;i++){if(parseFloat(response.data[i].tag_name.substring(1))===highestVersion){var downloadLink=response.data[i].assets[0].browser_download_url;}}}console.log('downloadLink = ',downloadLink);}).catch(error=>{console.log('Could not reach Github to check for latest release');console.log(error);});const myHomeView=new src_Home();// myHomeView.getTab();
const HomeView=Object(es["a" /* observer */])(()=>{const dt=Object(react["useRef"])(null);const TableHeader=(headerName,theClass,filterID)=>{const exportCSV=()=>{dt.current.exportCSV();};return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"table-header",children:[headerName,/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{style:{textAlign:"left"},children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{type:"button",icon:"pi pi-external-link",label:"Export",onClick:exportCSV},void 0,false,{fileName:src_jsxFileName,lineNumber:123,columnNumber:42},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:123,columnNumber:7},undefined),filterID!==''?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{className:"p-input-icon-right",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("i",{className:"pi pi-search"},void 0,false,{fileName:src_jsxFileName,lineNumber:126,columnNumber:11},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(inputtext["InputText"],{type:"search",value:theClass[filterID],onInput:e=>theClass[filterID]=e.target.value,placeholder:"Search"},void 0,false,{fileName:src_jsxFileName,lineNumber:127,columnNumber:11},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:125,columnNumber:9},undefined):false]},void 0,true,{fileName:src_jsxFileName,lineNumber:121,columnNumber:5},undefined);};return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:[myHomeView.showStart?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{label:"Start Exabeam Enhancement Suite",onClick:()=>myHomeView.getTab()},void 0,false,{fileName:src_jsxFileName,lineNumber:139,columnNumber:11},undefined):false,myHomeView.showHome?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-6",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h2",{children:"New Rule Tuning Session"},void 0,false,{fileName:src_jsxFileName,lineNumber:144,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"form-group",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("label",{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Previous days to query"},void 0,false,{fileName:src_jsxFileName,lineNumber:146,columnNumber:26},undefined)," "]},void 0,true,{fileName:src_jsxFileName,lineNumber:146,columnNumber:19},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(inputtext["InputText"],{value:myHomeView.queryUnitNum,onInput:e=>myHomeView.queryUnitNum=e.target.value},void 0,false,{fileName:src_jsxFileName,lineNumber:147,columnNumber:19},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:145,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"form-group",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("label",{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Risk Score Greater Than"},void 0,false,{fileName:src_jsxFileName,lineNumber:150,columnNumber:26},undefined)," "]},void 0,true,{fileName:src_jsxFileName,lineNumber:150,columnNumber:19},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(inputtext["InputText"],{value:myHomeView.queryRiskScore,onInput:e=>myHomeView.queryRiskScore=e.target.value},void 0,false,{fileName:src_jsxFileName,lineNumber:151,columnNumber:19},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:149,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{label:"Get User Sessions",onClick:()=>myHomeView.getNotables('session')},void 0,false,{fileName:src_jsxFileName,lineNumber:153,columnNumber:15},undefined)," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:153,columnNumber:102},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{label:"Get Asset Sessions",onClick:()=>myHomeView.getNotables('asset')},void 0,false,{fileName:src_jsxFileName,lineNumber:154,columnNumber:15},undefined)," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:154,columnNumber:101},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:143,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-6",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h2",{children:"New Data Validation Session (BETA)"},void 0,false,{fileName:src_jsxFileName,lineNumber:157,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"form-group",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("label",{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Previous days to query"},void 0,false,{fileName:src_jsxFileName,lineNumber:159,columnNumber:28},undefined)," "]},void 0,true,{fileName:src_jsxFileName,lineNumber:159,columnNumber:21},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(inputtext["InputText"],{value:myHomeView.queryUnitNum,onInput:e=>myHomeView.queryUnitNum=e.target.value},void 0,false,{fileName:src_jsxFileName,lineNumber:160,columnNumber:21},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:158,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{label:"Start Data Validation",onClick:()=>myHomeView.startValidation()},void 0,false,{fileName:src_jsxFileName,lineNumber:162,columnNumber:17},undefined)," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:162,columnNumber:103},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:156,columnNumber:13},undefined)]},void 0,true):false,myHomeView.showHome&&myHomeView.showpRuleTuning?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-12",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h2",{children:"Previous Tuning Sessions"},void 0,false,{fileName:src_jsxFileName,lineNumber:169,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.previousRuleTuning,className:"p-datatable-sm",ref:dt,paginator:true,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",rows:5,rowsPerPageOptions:[5,10,20,50],header:TableHeader('Previous Tuning Sessions',myHomeView,'previousRuleTuningGlobalFilter'),globalFilter:myHomeView.previousRuleTuningGlobalFilter,loading:myHomeView.loading,resizableColumns:true,sortField:"id",sortOrder:-1,children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{header:"Open",body:myHomeView.openTableButtonRuleTuning},void 0,false,{fileName:src_jsxFileName,lineNumber:175,columnNumber:15},undefined),myHomeView.pRuleTuningDynamicColumns,/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{header:"Del",body:myHomeView.delTableButtonRuleTuning},void 0,false,{fileName:src_jsxFileName,lineNumber:177,columnNumber:15},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:170,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:168,columnNumber:11},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:167,columnNumber:9},undefined):false,myHomeView.showHome&&myHomeView.showpDataValidation?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-12",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h2",{children:"Previous Data Validation Sessions"},void 0,false,{fileName:src_jsxFileName,lineNumber:184,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.previousDataValidation,className:"p-datatable-sm",ref:dt,paginator:true,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",rows:5,rowsPerPageOptions:[5,10,20,50],header:TableHeader('Previous Data Validation Sessions',myHomeView,'previousDataValidationGlobalFilter'),globalFilter:myHomeView.previousDataValidationGlobalFilter,loading:myHomeView.loading,resizableColumns:true,sortField:"id",sortOrder:-1,children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{header:"Open",body:myHomeView.openTableButtonDataValidation},void 0,false,{fileName:src_jsxFileName,lineNumber:190,columnNumber:15},undefined),myHomeView.pDataValidationDynamicColumns,/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{header:"Del",body:myHomeView.delTableButtonDataValidation},void 0,false,{fileName:src_jsxFileName,lineNumber:192,columnNumber:15},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:185,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:183,columnNumber:11},undefined):false]},void 0,true,{fileName:src_jsxFileName,lineNumber:137,columnNumber:7},undefined)},void 0,false);});const RuleTuningView=Object(es["a" /* observer */])(()=>{const dt=Object(react["useRef"])(null);const TableHeader=(headerName,theClass,filterID)=>{const exportCSV=()=>{dt.current.exportCSV();};return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"table-header",children:[headerName,/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{style:{textAlign:"left"},children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{type:"button",icon:"pi pi-external-link",label:"Export",onClick:exportCSV},void 0,false,{fileName:src_jsxFileName,lineNumber:215,columnNumber:42},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:215,columnNumber:7},undefined),filterID!==''?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{className:"p-input-icon-right",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("i",{className:"pi pi-search"},void 0,false,{fileName:src_jsxFileName,lineNumber:218,columnNumber:11},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(inputtext["InputText"],{type:"search",value:theClass[filterID],onInput:e=>theClass[filterID]=e.target.value,placeholder:"Search"},void 0,false,{fileName:src_jsxFileName,lineNumber:219,columnNumber:11},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:217,columnNumber:9},undefined):false]},void 0,true,{fileName:src_jsxFileName,lineNumber:213,columnNumber:5},undefined);};return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[myHomeView.showTuning?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-3",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(card["Card"],{title:"Summary of Sessions",style:{marginBottom:'2em'},children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Total Session Scores:"},void 0,false,{fileName:src_jsxFileName,lineNumber:233,columnNumber:13},undefined)," ",myHomeView.uSessionSummaryRiskScore," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:233,columnNumber:80},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Total Session Count:"},void 0,false,{fileName:src_jsxFileName,lineNumber:234,columnNumber:13},undefined)," ",myHomeView.uSessionSummarySessionCount," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:234,columnNumber:82},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Notable Session Count:"},void 0,false,{fileName:src_jsxFileName,lineNumber:235,columnNumber:13},undefined)," ",myHomeView.uSessionSummaryNotableCount," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:235,columnNumber:84},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Notable Per Day (Average):"},void 0,false,{fileName:src_jsxFileName,lineNumber:236,columnNumber:13},undefined)," ",myHomeView.uSessionSummaryNotablePerDay," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:236,columnNumber:89},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{label:"Back",onClick:()=>myHomeView.toggleShowHome()},void 0,false,{fileName:src_jsxFileName,lineNumber:237,columnNumber:13},undefined)," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:237,columnNumber:81},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:232,columnNumber:11},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:231,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-3",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(card["Card"],{title:"Results of Tuning",style:{marginBottom:'2em'},children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Session Scores:"},void 0,false,{fileName:src_jsxFileName,lineNumber:242,columnNumber:13},undefined)," ",myHomeView.uSessionSummaryTunedRiskScore," ",myHomeView.uSessionSummaryTunedRiskScorePercent?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{style:{color:'green'},children:["(",myHomeView.uSessionSummaryTunedRiskScorePercent,"%) "]},void 0,true,{fileName:src_jsxFileName,lineNumber:242,columnNumber:130},undefined):false," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:242,columnNumber:230},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Notable Session Count:"},void 0,false,{fileName:src_jsxFileName,lineNumber:243,columnNumber:13},undefined)," ",myHomeView.uSessionSummaryTunedNotableCount," ",myHomeView.uSessionSummaryTunedRiskScorePercent?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{style:{color:'green'},children:["(",myHomeView.uSessionSummaryTunedNotableCountPercent,"%) "]},void 0,true,{fileName:src_jsxFileName,lineNumber:243,columnNumber:140},undefined):false,"  ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:243,columnNumber:243},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Notable Per Day (Average):"},void 0,false,{fileName:src_jsxFileName,lineNumber:244,columnNumber:13},undefined)," ",myHomeView.uSessionSummaryTunedNotablePerDay," ",myHomeView.uSessionSummaryTunedRiskScorePercent?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{style:{color:'green'},children:["(",myHomeView.uSessionSummaryTunedNotablePerDayPercent,"%) "]},void 0,true,{fileName:src_jsxFileName,lineNumber:244,columnNumber:145},undefined):false,"  ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:244,columnNumber:249},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:241,columnNumber:11},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:240,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-6",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(card["Card"],{title:"Tuned Rule Conditions",style:{marginBottom:'2em'},children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(treetable["TreeTable"],{value:myHomeView.ruleTuning,children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"name",header:"Rule",expander:true},void 0,false,{fileName:src_jsxFileName,lineNumber:250,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"value",header:"Event Value"},void 0,false,{fileName:src_jsxFileName,lineNumber:251,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"count",header:"Rule Count"},void 0,false,{fileName:src_jsxFileName,lineNumber:252,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"score",header:"Score"},void 0,false,{fileName:src_jsxFileName,lineNumber:253,columnNumber:15},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:249,columnNumber:13},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:248,columnNumber:11},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:247,columnNumber:9},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:230,columnNumber:7},undefined):false,myHomeView.showTuning&&!myHomeView.showEvents?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-4",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h2",{children:"Breakdown by Entity"},void 0,false,{fileName:src_jsxFileName,lineNumber:262,columnNumber:11},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.userData,className:"p-datatable-sm",ref:dt,paginator:true,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",rows:20,rowsPerPageOptions:[5,10,20,50],header:TableHeader('Breakdown by Entity',myHomeView,'userDataGlobalFilter'),globalFilter:myHomeView.userDataGlobalFilter,loading:myHomeView.loading,resizableColumns:true,sortField:"totalScore",sortOrder:-1,children:myHomeView.userDataDynamicColumns},void 0,false,{fileName:src_jsxFileName,lineNumber:263,columnNumber:11},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:261,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-8",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h2",{children:"Breakdown by Rule"},void 0,false,{fileName:src_jsxFileName,lineNumber:272,columnNumber:11},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.ruleData,className:"p-datatable-sm",ref:dt,paginator:true,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",rows:20,rowsPerPageOptions:[5,10,20,50],header:TableHeader('Breakdown by Rule',myHomeView,'ruleDataGlobalFilter'),globalFilter:myHomeView.ruleDataGlobalFilter,loading:myHomeView.loading,resizableColumns:true,columnResizeMode:"fit",sortField:"totalScore",sortOrder:-1,children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{header:"Open",body:myHomeView.openTableButtonSelectRule},void 0,false,{fileName:src_jsxFileName,lineNumber:278,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"rule",header:"Rule ID",sortable:true,filter:true,filterMatchMode:"contains",style:{width:'15%'}},void 0,false,{fileName:src_jsxFileName,lineNumber:279,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"ruleName",header:"Rule Name",sortable:true,filter:true,filterMatchMode:"contains",style:{width:'30%'}},void 0,false,{fileName:src_jsxFileName,lineNumber:280,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"count",header:"Triggers",sortable:true,style:{width:'15%'}},void 0,false,{fileName:src_jsxFileName,lineNumber:281,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"sessionCount",header:"Sessions",body:tablePercentFormat,sortable:true,style:{width:'15%'}},void 0,false,{fileName:src_jsxFileName,lineNumber:282,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"totalScore",header:"Total Score",body:tablePercentFormat,sortable:true,style:{width:'15%'}},void 0,false,{fileName:src_jsxFileName,lineNumber:283,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:273,columnNumber:11},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:271,columnNumber:9},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:260,columnNumber:7},undefined):false,!myHomeView.showTuning&&myHomeView.showEvents?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-12",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(card["Card"],{title:myHomeView.selectedRuleHeader,style:{width:'25rem',marginBottom:'2em'},children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Event Count: "},void 0,false,{fileName:src_jsxFileName,lineNumber:293,columnNumber:13},undefined)," ",myHomeView.selectedRuleCount," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:293,columnNumber:65},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Session Count: "},void 0,false,{fileName:src_jsxFileName,lineNumber:294,columnNumber:13},undefined)," ",myHomeView.selectedRuleSessionCount," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:294,columnNumber:74},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("b",{children:"Total Score: "},void 0,false,{fileName:src_jsxFileName,lineNumber:295,columnNumber:13},undefined)," ",myHomeView.selectedRuleScore," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:295,columnNumber:65},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{label:"Back",onClick:()=>myHomeView.toggleShowEvents()},void 0,false,{fileName:src_jsxFileName,lineNumber:296,columnNumber:13},undefined)," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:296,columnNumber:83},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:292,columnNumber:11},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:291,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-12",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h2",{children:"Events"},void 0,false,{fileName:src_jsxFileName,lineNumber:300,columnNumber:11},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.eventSummaryDataDone,className:"p-datatable-sm",ref:dt,paginator:true,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",rows:20,rowsPerPageOptions:[5,10,20,50],header:TableHeader('Events',myHomeView,'eventSummaryGlobalFilter'),globalFilter:myHomeView.eventSummaryGlobalFilter,loading:myHomeView.loading,resizableColumns:true,columnResizeMode:"fit",sortField:"totalScore",sortOrder:-1,children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{header:"Open",body:myHomeView.openTableButtonFilterEvent},void 0,false,{fileName:src_jsxFileName,lineNumber:306,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"fieldName",header:"Field Name",sortable:true,filter:true,filterMatchMode:"contains",style:{width:'15%'}},void 0,false,{fileName:src_jsxFileName,lineNumber:307,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"fieldValue",header:"Value",body:eventValueFormat,sortable:true,filter:true,filterMatchMode:"contains",style:{width:'30%'}},void 0,false,{fileName:src_jsxFileName,lineNumber:308,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"count",header:"Event Count",body:tablePercentFormat,sortable:true,style:{width:'15%'}},void 0,false,{fileName:src_jsxFileName,lineNumber:309,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"sessionCount",header:"Session Count",body:tablePercentFormat,sortable:true,style:{width:'15%'}},void 0,false,{fileName:src_jsxFileName,lineNumber:310,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"totalScore",header:"Total Score",body:tablePercentFormat,sortable:true,style:{width:'15%'}},void 0,false,{fileName:src_jsxFileName,lineNumber:311,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:301,columnNumber:11},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:299,columnNumber:9},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:290,columnNumber:7},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:289,columnNumber:5},undefined):false]},void 0,true);});const DataValidationTables=Object(es["a" /* observer */])(()=>{const dt=Object(react["useRef"])(null);const TableHeader=(headerName,theClass,filterID)=>{const exportCSV=()=>{dt.current.exportCSV();};return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"table-header",children:[headerName,/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{style:{textAlign:"left"},children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{type:"button",icon:"pi pi-external-link",label:"Export",onClick:exportCSV},void 0,false,{fileName:src_jsxFileName,lineNumber:335,columnNumber:42},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:335,columnNumber:7},undefined),filterID!==''?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{className:"p-input-icon-right",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("i",{className:"pi pi-search"},void 0,false,{fileName:src_jsxFileName,lineNumber:338,columnNumber:11},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(inputtext["InputText"],{type:"search",value:theClass[filterID],onInput:e=>theClass[filterID]=e.target.value,placeholder:"Search"},void 0,false,{fileName:src_jsxFileName,lineNumber:339,columnNumber:11},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:337,columnNumber:9},undefined):false]},void 0,true,{fileName:src_jsxFileName,lineNumber:333,columnNumber:5},undefined);};return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:myHomeView.showValidation?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-12",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h1",{children:"Data Validation"},void 0,false,{fileName:src_jsxFileName,lineNumber:352,columnNumber:9},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:351,columnNumber:7},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:350,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(tabview["TabView"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(tabview["TabPanel"],{header:"Data Sources",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-12",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:"Data Sources"},void 0,false,{fileName:src_jsxFileName,lineNumber:359,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.sourcesDone,className:"p-datatable-sm",ref:dt,header:TableHeader('',myHomeView,''),loading:myHomeView.loading,resizableColumns:true,columnResizeMode:"fit",sortField:"configIssues",sortOrder:-1,children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{header:"Open",body:myHomeView.openTableButtonSelectSource},void 0,false,{fileName:src_jsxFileName,lineNumber:363,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"source",header:"Source",sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:364,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"name",header:"Event Type",sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:365,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"inSession",header:"User Sessions",body:myHomeView.booleanFormat,sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:366,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"inAsset",header:"Asset Sessions",body:myHomeView.booleanFormat,sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:367,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"configIssues",header:"Missing Events",body:myHomeView.openTableButtonSelectConfigIssue,sortable:true,filter:true,filterMatchMode:"gte"},void 0,false,{fileName:src_jsxFileName,lineNumber:368,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"parsingIssues",header:"Parsing Issues",body:myHomeView.openTableButtonSelectParsingIssue,sortable:true,filter:true,filterMatchMode:"gte"},void 0,false,{fileName:src_jsxFileName,lineNumber:369,columnNumber:15},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:360,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:358,columnNumber:11},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:357,columnNumber:9},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:356,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(tabview["TabPanel"],{header:"Event Types",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-12",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:"Event Types"},void 0,false,{fileName:src_jsxFileName,lineNumber:377,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.eventTypesDone,className:"p-datatable-sm",ref:dt,header:TableHeader('',myHomeView,''),loading:myHomeView.loading,resizableColumns:true,columnResizeMode:"fit",sortField:"name",sortOrder:1,children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"name",header:"Event Type",sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:381,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"inSession",header:"User Sessions",body:myHomeView.booleanFormat,sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:382,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"inAsset",header:"Asset Sessions",body:myHomeView.booleanFormat,sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:383,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"source",header:"Users",body:myHomeView.eventTypeUsers,sortable:true},void 0,false,{fileName:src_jsxFileName,lineNumber:384,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"source",header:"Hosts",body:myHomeView.eventTypeHosts,sortable:true},void 0,false,{fileName:src_jsxFileName,lineNumber:385,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"source",header:"Field Count",body:myHomeView.eventTypeFields,sortable:true},void 0,false,{fileName:src_jsxFileName,lineNumber:386,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"source",header:"Models Populating",body:myHomeView.eventTypeModelsPopulating,sortable:true},void 0,false,{fileName:src_jsxFileName,lineNumber:387,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"source",header:"Rules Can Trigger",body:myHomeView.eventTypeRulesCouldTrigger,sortable:true},void 0,false,{fileName:src_jsxFileName,lineNumber:388,columnNumber:17},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:378,columnNumber:15},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:376,columnNumber:13},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:375,columnNumber:11},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:374,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(tabview["TabPanel"],{header:"Rules",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-12",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:"Rules"},void 0,false,{fileName:src_jsxFileName,lineNumber:396,columnNumber:15},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.rulesAndModelsDone,className:"p-datatable-sm",ref:dt,paginator:true,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",rows:20,rowsPerPageOptions:[5,10,20,50],header:TableHeader('',myHomeView,'rulesAndModelsGlobalFilter'),globalFilter:myHomeView.rulesAndModelsGlobalFilter,loading:myHomeView.loading,resizableColumns:true,columnResizeMode:"fit",sortField:"ruleCat",sortOrder:1,children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"ruleCat",header:"Rule Category",sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:402,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"ruleId",header:"Rule ID",body:myHomeView.rulesAndModelsRuleId,sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:403,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"ruleName",header:"Rule Name",sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:404,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"modelName",header:"Model",body:myHomeView.rulesAndModelsModelName,sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:405,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"modelDisabled",header:"Disabled",sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:406,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"eventInRuleType",header:"Event Present",body:myHomeView.rulesAndModelsEventInRule,sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:407,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"featurePresent",header:"Feature Present",body:myHomeView.booleanFormat,sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:408,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"populating",header:"Model Populating",body:myHomeView.booleanFormat,sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:409,columnNumber:17},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"hasTriggered",header:"Has Triggered",body:myHomeView.booleanFormat,sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:410,columnNumber:17},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:397,columnNumber:15},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:395,columnNumber:13},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:394,columnNumber:11},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:393,columnNumber:9},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:355,columnNumber:5},undefined)]},void 0,true):false},void 0,false);});const Dialogs=Object(es["a" /* observer */])(()=>{const dt=Object(react["useRef"])(null);const TableHeader=(headerName,theClass,filterID)=>{const exportCSV=()=>{dt.current.exportCSV();};return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"table-header",children:[headerName,/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{style:{textAlign:"left"},children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(primereact_button["Button"],{type:"button",icon:"pi pi-external-link",label:"Export",onClick:exportCSV},void 0,false,{fileName:src_jsxFileName,lineNumber:434,columnNumber:42},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:434,columnNumber:7},undefined),filterID!==''?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{className:"p-input-icon-right",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("i",{className:"pi pi-search"},void 0,false,{fileName:src_jsxFileName,lineNumber:437,columnNumber:11},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(inputtext["InputText"],{type:"search",value:theClass[filterID],onInput:e=>theClass[filterID]=e.target.value,placeholder:"Search"},void 0,false,{fileName:src_jsxFileName,lineNumber:438,columnNumber:11},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:436,columnNumber:9},undefined):false]},void 0,true,{fileName:src_jsxFileName,lineNumber:432,columnNumber:5},undefined);};return/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(dialog["Dialog"],{header:"Data Validation Progress",visible:myHomeView.visibleDataValidationProgress,style:{width:'80vw'},onHide:()=>myHomeView.onHide('visibleDataValidationProgress'),children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("p",{children:["Models: ",myHomeView.doneCountModels," out of ",myHomeView.todoModels]},void 0,true,{fileName:src_jsxFileName,lineNumber:448,columnNumber:7},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("p",{children:["Rules: ",myHomeView.doneCountRules," out of ",myHomeView.todoRules]},void 0,true,{fileName:src_jsxFileName,lineNumber:449,columnNumber:7},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("p",{children:["Event Types: ",myHomeView.doneCountEventTypes," out of ",myHomeView.todoEventTypes]},void 0,true,{fileName:src_jsxFileName,lineNumber:450,columnNumber:7},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("p",{children:["User Sessions: ",myHomeView.doneCountEventTypeSessions," out of ",myHomeView.todoEventTypeSessions]},void 0,true,{fileName:src_jsxFileName,lineNumber:451,columnNumber:7},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("p",{children:["User Session Events: ",myHomeView.doneCountEventTypeSessionsDetails," out of ",myHomeView.todoEventTypeSessionsDetails]},void 0,true,{fileName:src_jsxFileName,lineNumber:452,columnNumber:7},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("p",{children:["Asset Sessions: ",myHomeView.doneCountEventTypeAssets," out of ",myHomeView.todoEventTypeAssets]},void 0,true,{fileName:src_jsxFileName,lineNumber:453,columnNumber:7},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("p",{children:["Raw Event Fetch: ",myHomeView.doneRawEventsCount," out of ",myHomeView.todoRawEventsCount]},void 0,true,{fileName:src_jsxFileName,lineNumber:455,columnNumber:7},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(progressbar["ProgressBar"],{value:myHomeView.dataValidationProgress},void 0,false,{fileName:src_jsxFileName,lineNumber:456,columnNumber:7},undefined),myHomeView.errorVisible?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(jsx_dev_runtime["Fragment"],{children:[myHomeView.rawEventErrors>0?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("span",{children:["Raw Event Errors: ",myHomeView.rawEventErrors," ",/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("br",{},void 0,false,{fileName:src_jsxFileName,lineNumber:462,columnNumber:60},undefined),"Will retry up to 10 times, retry attempt = ",myHomeView.retryAttemptRawEventsCount]},void 0,true,{fileName:src_jsxFileName,lineNumber:461,columnNumber:13},undefined):false,myHomeView.errors.length>0?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:[" ",prettyJson(myHomeView.errors)," "]},void 0,true,{fileName:src_jsxFileName,lineNumber:467,columnNumber:13},undefined):false]},void 0,true):false]},void 0,true,{fileName:src_jsxFileName,lineNumber:447,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(dialog["Dialog"],{header:"Timeline Analysis Progress",visible:myHomeView.visibleTuningProgress,style:{width:'80vw'},onHide:()=>myHomeView.onHide('visibleTuningProgress'),children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("p",{children:["Timelines: ",myHomeView.doneCountTimelines," out of ",myHomeView.todoTimelines]},void 0,true,{fileName:src_jsxFileName,lineNumber:476,columnNumber:7},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(progressbar["ProgressBar"],{value:myHomeView.tuningProgress},void 0,false,{fileName:src_jsxFileName,lineNumber:477,columnNumber:7},undefined),myHomeView.errorVisible?/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.errors)},void 0,false,{fileName:src_jsxFileName,lineNumber:479,columnNumber:11},undefined):false]},void 0,true,{fileName:src_jsxFileName,lineNumber:475,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(dialog["Dialog"],{header:"Event Types",visible:myHomeView.visibleMissingEventTypes,style:{width:'80vw'},onHide:()=>myHomeView.onHide('visibleMissingEventTypes'),children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-6",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:"Required Event Types"},void 0,false,{fileName:src_jsxFileName,lineNumber:488,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.selectedRequiredEventTypes)},void 0,false,{fileName:src_jsxFileName,lineNumber:489,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:487,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-6",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:"Present Event Types"},void 0,false,{fileName:src_jsxFileName,lineNumber:493,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.selectedPresentEventTypes)},void 0,false,{fileName:src_jsxFileName,lineNumber:494,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:492,columnNumber:9},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:486,columnNumber:7},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:485,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(dialog["Dialog"],{header:"Source",visible:myHomeView.visibleSelectedSource,style:{width:'80vw'},onHide:()=>myHomeView.onHide('visibleSelectedSource'),children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-6",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:myHomeView.sessionHeader},void 0,false,{fileName:src_jsxFileName,lineNumber:502,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.selectedSourceSessionEvents)},void 0,false,{fileName:src_jsxFileName,lineNumber:503,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:501,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-6",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:myHomeView.assetHeader},void 0,false,{fileName:src_jsxFileName,lineNumber:506,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.selectedSourceAssetEvents)},void 0,false,{fileName:src_jsxFileName,lineNumber:507,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:505,columnNumber:9},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:500,columnNumber:7},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:499,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(dialog["Dialog"],{header:"Event Fields",visible:myHomeView.visibleMissingEventFields,style:{width:'80vw'},onHide:()=>myHomeView.onHide('visibleMissingEventFields'),children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-4",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:"Present Event Fields (User Sessions)"},void 0,false,{fileName:src_jsxFileName,lineNumber:515,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.selectedSessionEventFields)},void 0,false,{fileName:src_jsxFileName,lineNumber:516,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:514,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-4",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:"Present Event Fields (Asset Sessions)"},void 0,false,{fileName:src_jsxFileName,lineNumber:519,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.selectedAssetEventFields)},void 0,false,{fileName:src_jsxFileName,lineNumber:520,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:518,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-4",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:"Missing Event Fields"},void 0,false,{fileName:src_jsxFileName,lineNumber:523,columnNumber:11},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.selectedMissingEventFieldTable,className:"p-datatable-sm",ref:dt,resizableColumns:true,columnResizeMode:"fit",sortField:"count",sortOrder:-1,children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"name",header:"Field",sortable:true},void 0,false,{fileName:src_jsxFileName,lineNumber:526,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"count",header:"Models Dependant",sortable:true},void 0,false,{fileName:src_jsxFileName,lineNumber:527,columnNumber:13},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{header:"Percent",body:myHomeView.eventFieldsMissingTable,sortable:true},void 0,false,{fileName:src_jsxFileName,lineNumber:528,columnNumber:13},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:524,columnNumber:11},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:522,columnNumber:9},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:513,columnNumber:7},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:512,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(dialog["Dialog"],{header:"Rule",visible:myHomeView.visibleRule,style:{width:'80vw'},onHide:()=>myHomeView.onHide('visibleRule'),children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.selectedRule)},void 0,false,{fileName:src_jsxFileName,lineNumber:535,columnNumber:9},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:534,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(dialog["Dialog"],{header:"Model",visible:myHomeView.visibleModel,style:{width:'80vw'},onHide:()=>myHomeView.onHide('visibleModel'),children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.selectedModel)},void 0,false,{fileName:src_jsxFileName,lineNumber:539,columnNumber:9},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:538,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(dialog["Dialog"],{header:"User List",visible:myHomeView.visibleUserList,style:{width:'80vw'},onHide:()=>myHomeView.onHide('visibleUserList'),children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.selectedUserList,className:"p-datatable-sm",ref:dt,resizableColumns:true,columnResizeMode:"fit",sortField:"name",sortOrder:1,children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"name",header:"User",sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:545,columnNumber:9},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:543,columnNumber:7},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:542,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(dialog["Dialog"],{header:"Host List",visible:myHomeView.visibleHostList,style:{width:'80vw'},onHide:()=>myHomeView.onHide('visibleHostList'),children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(datatable["DataTable"],{value:myHomeView.selectedHostList,className:"p-datatable-sm",ref:dt,resizableColumns:true,columnResizeMode:"fit",sortField:"name",sortOrder:1,children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(column["Column"],{field:"name",header:"Host",sortable:true,filter:true,filterMatchMode:"contains"},void 0,false,{fileName:src_jsxFileName,lineNumber:552,columnNumber:9},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:550,columnNumber:7},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:549,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(dialog["Dialog"],{header:"Parsing Issues",visible:myHomeView.visibleParsingIssues,style:{width:'80vw'},onHide:()=>myHomeView.onHide('visibleParsingIssues'),children:/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-grid",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-6",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:"User Event Fields Parsed Different in DL"},void 0,false,{fileName:src_jsxFileName,lineNumber:559,columnNumber:11},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.sessionParsingIssues,3)},void 0,false,{fileName:src_jsxFileName,lineNumber:560,columnNumber:11},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:558,columnNumber:9},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{className:"p-col-6",children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("h3",{children:"Asset Event Fields Parsed Different in DL"},void 0,false,{fileName:src_jsxFileName,lineNumber:563,columnNumber:11},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])("div",{children:prettyJson(myHomeView.assetParsingIssues,3)},void 0,false,{fileName:src_jsxFileName,lineNumber:564,columnNumber:11},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:562,columnNumber:9},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:557,columnNumber:7},undefined)},void 0,false,{fileName:src_jsxFileName,lineNumber:556,columnNumber:5},undefined)]},void 0,true);});react_dom_default.a.render(/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(react_default.a.StrictMode,{children:[/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(HomeView,{},void 0,false,{fileName:src_jsxFileName,lineNumber:578,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(RuleTuningView,{},void 0,false,{fileName:src_jsxFileName,lineNumber:579,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(DataValidationTables,{},void 0,false,{fileName:src_jsxFileName,lineNumber:580,columnNumber:5},undefined),/*#__PURE__*/Object(jsx_dev_runtime["jsxDEV"])(Dialogs,{},void 0,false,{fileName:src_jsxFileName,lineNumber:581,columnNumber:5},undefined)]},void 0,true,{fileName:src_jsxFileName,lineNumber:577,columnNumber:3},undefined),document.getElementById('root'));// If you want to start measuring performance in your app, pass a function
// to log results (for example: reportWebVitals(console.log))
// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals
src_reportWebVitals();

/***/ }),

/***/ 50:
/***/ (function(module, exports) {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = function() { return []; };
webpackEmptyContext.resolve = webpackEmptyContext;
module.exports = webpackEmptyContext;
webpackEmptyContext.id = 50;

/***/ }),

/***/ 51:
/***/ (function(module, exports) {

/* (ignored) */

/***/ })

},[[141,1,2]]]);
//# sourceMappingURL=main.8b75bdbc.chunk.js.map